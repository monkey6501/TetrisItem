function instanceOfIStageResizeable(e){return"resize"in e}var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},__awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(t){a(t)}}function s(e){try{c(n["throw"](e))}catch(t){a(t)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,s)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,a&&(i=a[2&r[0]?"return":r[0]?"throw":"next"])&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[0,i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,a=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(i=c.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(n){r=[6,n],a=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,a,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},UI;!function(e){var t=function(e){function t(t){var r=e.call(this)||this;r._bottom=0,r._centerTop=0,r._centerBottom=0,r.startY=0,r.isCache=!0,r._needLoadResGroupList=[],r._needLoadResItemList=[],r.uiName="",r.type=0,r.isComplete=!1,r.fullScreen=!1;var n=r;return n.uiskinPath=t,r}return __extends(t,e),t.prototype.init=function(e,t){var r=this;this.data=e,r.loadRes()},t.prototype.initSkinView=function(){var e=this;e.isComplete?e.show():this.addEventListener(eui.UIEvent.COMPLETE,this.createCompleteEvent,this),this.skinName=this.uiskinPath},t.prototype.createCompleteEvent=function(e){var t=this;t.isComplete=!0,t.removeEventListener(eui.UIEvent.COMPLETE,t.createCompleteEvent,this),LanguageManager.getInstance.setModuleLanguage(t),t.addEvents(),t.show()},Object.defineProperty(t.prototype,"tabIndex",{get:function(){return this._tabIndex},set:function(e){this._tabIndex=e,this.skin_window&&(this.skin_window.tabIndex=this._tabIndex)},enumerable:!0,configurable:!0}),t.prototype.onTabClick=function(e){this._tabIndex=e},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.group_bottom&&this.group_bottom.addEventListener(egret.Event.RESIZE,this.onBottomResize,this),this.onStageResize()},t.prototype.onStageResize=function(){var e=this;e.group_bottom&&e.onBottomResize(),e.group_center&&e.onCenterResize(),e.group_scaleX&&e.onGroupScaleX()},t.prototype.onGroupScaleX=function(){var e=this;e.group_scaleX&&(e.group_scaleX.x=0,e.group_scaleX.y=0,e.group_scaleX.width=StageUtils.getInstance.stage.stageWidth,e.group_scaleX.height=StageUtils.getInstance.stage.stageHeight)},t.prototype.onBottomResize=function(){var e=this;e.group_bottom&&(e._bottom=e.group_bottom.bottom||e._bottom,e.group_bottom.bottom=void 0,e.group_bottom.y=StageUtils.getInstance.stage.stageHeight-e._bottom-e.group_bottom.height+e.startY)},t.prototype.onCenterResize=function(){var e=this;this.group_center&&(e._centerTop=e.group_center.top||e._centerTop,e.group_center.top=void 0,e._centerBottom=e.group_center.bottom||e._centerBottom,e.group_center.bottom=void 0,e.group_center.y=e._centerTop,e.group_center.height=StageUtils.getInstance.stage.stageHeight-e._centerBottom-e._centerTop+e.startY)},t.prototype.loadRes=function(){var e=this,t=e.getNeedResGroup().concat(e.getNeedResItemList());null!=t&&t.length>0?ResUtil.getInstance.loadGroupWithPro(t,e.loadComplete,null,e):e.loadComplete()},t.prototype.loadComplete=function(){var e=this;e.initSkinView()},t.prototype.hasData=function(e){for(var t=this,r=t.getDatas(),n=0;n<r.length;n++)if(r[n]==e)return!0;return!1},t.prototype.getDatas=function(){return null},t.prototype.onDataChanged=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},t.prototype.getNeedResGroup=function(){return this._needLoadResGroupList},t.prototype.getNeedResItemList=function(){return this._needLoadResItemList},t.prototype.getName=function(){return null},t.prototype.getBackName=function(){return null},t.prototype.show=function(){var e=this;e.showCreatAccountView()},t.prototype.update=function(e){e&&(this._data=e)},t.prototype.showToStage=function(){},t.prototype.showCreatAccountView=function(){var e=this;e.showToStage()},t.prototype.addEvents=function(){},t.prototype.removeEvents=function(){},t.prototype.close=function(){var e=this;ScenesManager.getInstance.currView=null,e.dispose()},t.prototype.hide=function(){},t.prototype.isNeedToRelease=function(){return!0},t.prototype.dispose=function(){var e=this;e.removeEvents(),e.data=null,0==e.isCache&&e.disposeRes(),e.group_bottom&&e.group_bottom.removeEventListener(egret.Event.RESIZE,e.onBottomResize,e),e.hide(),e.skin_window&&e.skin_window.dispose(),e.fullScreen&&ScenesManager.getInstance.ShowScene(),ScenesManager.getInstance.views.Remove(e.uiName),ScenesManager.getInstance.currView=null,DisplayUtils.removeFromParent(e)},t.prototype.disposeRes=function(){var e=this;for(e.isComplete=!1;e._needLoadResGroupList&&e._needLoadResGroupList.length>0;){var t=e._needLoadResGroupList.pop();RES.destroyRes(t)}for(;e._needLoadResItemList&&e._needLoadResItemList.length>0;){var r=e._needLoadResItemList.pop();RES.destroyRes(r)}},t}(eui.Component);e.BaseView=t,__reflect(t.prototype,"UI.BaseView")}(UI||(UI={}));var UI;!function(e){var t=function(e){function t(t){var r=e.call(this,t)||this,n=r;return n.type=UIType.Scene,r}return __extends(t,e),t}(e.BaseView);e.BaseScene=t,__reflect(t.prototype,"UI.BaseScene")}(UI||(UI={}));var LoginView=function(e){function t(){return e.call(this,SkinName.LoginViewSkin)||this}return __extends(t,e),t.prototype.addEvents=function(){e.prototype.addEvents.call(this);var t=this;t.beginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.beginBtnHandler,t)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.beginBtnHandler=function(){var e=this;e.close(),ScenesManager.getInstance.openView(UIUtil.createScene(ViewClassName.GameMainView),LayerManager.GAME_UI_LAYER,!0)},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t}(UI.BaseScene);__reflect(LoginView.prototype,"LoginView");var BaseClass=function(){function e(){}return e.Instance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this;if(!r._instance){var n=e.length;0==n?r._instance=new r:1==n?r._instance=new r(e[0]):2==n?r._instance=new r(e[0],e[1]):3==n?r._instance=new r(e[0],e[1],e[2]):4==n?r._instance=new r(e[0],e[1],e[2],e[3]):5==n&&(r._instance=new r(e[0],e[1],e[2],e[3],e[4]))}return r._instance},e}();__reflect(BaseClass.prototype,"BaseClass");var TSDictionary=function(){function e(){this.keys=[],this.values=[],this._len=0}return e.prototype.Add=function(e,t){var r=this;r.keys.push(e),r.values.push(t),r._len++},e.prototype.Remove=function(e){var t=this,r=t.keys.indexOf(e,0);-1!=r&&(t.keys.splice(r,1),t.values.splice(r,1),t._len--)},e.prototype.TryGetValue=function(e){var t=this,r=t.keys.indexOf(e,0);return-1!=r?t.values[r]:null},e.prototype.TryGetKey=function(e){var t=this,r=t.values.indexOf(e,0);return-1!=r?t.keys[r]:null},e.prototype.TryGetListByCondition=function(e){for(var t=this,r=[],n=0,o=t.values;n<o.length;n++){var a=o[n];e(a)&&(r[r.length]=a)}return r},e.prototype.TryGetAnyByCondition=function(e){for(var t=this,r={},n=0,o=t.keys;n<o.length;n++){var a=o[n],i=t.keys.indexOf(a,0);e(t.values[i])&&(r[a]=t.values[i])}return r},e.prototype.TryGetKeyListByCondition=function(e){for(var t=this,r=[],n=0;n<t.keys.length;n++)e(t.keys[n])&&(r[r.length]=t.values[n]);return r},e.prototype.ContainsKey=function(e){for(var t=this,r=t.keys,n=0;n<r.length;++n)if(r[n]==e)return!0;return!1},e.prototype.SetDicValue=function(e,t){var r=this.keys.indexOf(e,0);return-1!=r?(this.keys[r]=e,this.values[r]=t,!0):(this.Add(e,t),!0)},e.prototype.SortByKey=function(){for(var e=this,t=e.keys.length-1;t>0;t--)for(var r=0;t>r;r++)if(Number(e.keys[r])>Number(e.keys[r+1])){var n=e.keys[r],o=e.values[r];e.keys[r]=e.keys[r+1],e.values[r]=e.values[r+1],e.keys[r+1]=n,e.values[r+1]=o}return!0},e.prototype.GetLenght=function(){return this._len},e.prototype.getValueByIndex=function(e){var t=this;if(!(0>e||e>=t._len)){var r=t.values[e];return r}},e.prototype.getKeyByIndex=function(e){var t=this;if(!(0>e||e>=t._len)){var r=t.keys[e];return r}},e.prototype.getValues=function(){return this.values},e.prototype.getkeys=function(){return this.keys},e.prototype.clear=function(){for(var e=this;e.keys.length>0;)e.keys.pop();for(;e.values.length>0;){var t=e.values.pop();t=null}e.keys.length=0,e.values.length=0,e._len=0},e}();__reflect(TSDictionary.prototype,"TSDictionary");var GameMainView=function(e){function t(){var t=e.call(this,SkinName.GameMainViewSkin)||this;return t.shapeList=[],t.mapItemList=[],t.moveItem=new TetrisItem,t.hammer=new eui.Image,t.destroyPos={},t.offSetX=0,t.offSetY=0,t.offSetX1=0,t.offSetY1=0,t}return __extends(t,e),t.prototype.addEvents=function(){e.prototype.addEvents.call(this);var t=this;t.destroyBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.destroyBtnHandler,t),t.restartBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.restartHandler,t),t.refreshBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.refreshBtnHandler,t),t.ranGroup1.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBeginHandler,t),t.ranGroup2.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBeginHandler,t),t.ranGroup3.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBeginHandler,t),t.addEventListener(egret.TouchEvent.TOUCH_END,t.touchEndHandler,t),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMoveHandler,t)},t.prototype.removeEvents=function(){var e=this;e.destroyBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.destroyBtnHandler,e),e.restartBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.restartHandler,e),e.refreshBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.refreshBtnHandler,e),e.ranGroup1.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHandler,e),e.ranGroup2.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHandler,e),e.ranGroup3.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHandler,e),e.removeEventListener(egret.TouchEvent.TOUCH_END,e.touchEndHandler,e),e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,e.touchMoveHandler,e)},t.prototype.show=function(){e.prototype.show.call(this);var t=this;t.randomTetrisItem(),t.createMap(),t.mapGroup.addChild(t.moveItem),t.mapGroup.addChild(t.hammer),t.hammer.source="game_json.icon1",t.hammer.visible=!1,t.moveItem.visible=!1,t.hammerLabel.text=LogicManager.HAMMER_TIMES+"",t.refreshLabel.text=LogicManager.REFRESH_TIMES+""},t.prototype.updataMap=function(){for(var e=this,t=0;t<LogicManager.MAP_ROW;t++)for(var r=0;r<LogicManager.MAP_COL;r++){var n=e.mapItemList[t][r];e.checkMapItem(e.moveItem,n)}},t.prototype.findItemByHammer=function(){var e=this,t=e.mapItemList[1][1],r=Math.floor(e.hammer.y/t.y),n=Math.floor(e.hammer.x/t.x);return LogicManager.getInstance.betweenTwoNumber(r,0,LogicManager.MAP_ROW-1)&&LogicManager.getInstance.betweenTwoNumber(n,0,LogicManager.MAP_COL-1)?e.mapItemList[r][n]:null},t.prototype.checkHammerMapItem=function(e){var t=this;t.destroyPos=e?{row:e.row,col:e.col}:null,t.showDestroyArea(e)},t.prototype.showDestroyArea=function(e){for(var t=this,r=0;r<LogicManager.MAP_ROW;r++)for(var n=0;n<LogicManager.MAP_COL;n++){var o=t.mapItemList[r][n];e&&LogicManager.getInstance.betweenTwoNumber(r,e.row-LogicManager.HAMMER_AREA,e.row+LogicManager.HAMMER_AREA)&&LogicManager.getInstance.betweenTwoNumber(n,e.col-LogicManager.HAMMER_AREA,e.col+LogicManager.HAMMER_AREA)?o.showDestroyShadow(1):o.showDestroyShadow(0)}},t.prototype.checkHammerInMap=function(){var e=this;return LogicManager.getInstance.inTouchArea(e.hammer.x+e.mapGroup.x,e.hammer.y+e.mapGroup.y,e.hammer.width,e.hammer.height,e.mapGroup)},t.prototype.touchEndMapItem=function(){for(var e=this,t=!1,r=0;r<LogicManager.MAP_ROW;r++)for(var n=0;n<LogicManager.MAP_COL;n++){var o=e.mapItemList[r][n];2==o.state&&(LogicManager.getInstance.score++,e.updataMapItem(r,n,1,o.color),t=!0)}return t},t.prototype.checkMapBlock=function(){for(var e=this,t=[],r=0;r<LogicManager.MAP_ROW;r++){t.push(r);for(var n=0;n<LogicManager.MAP_COL;n++){var o=e.mapItemList[r][n];if(1!=o.state){t.splice(-1);break}}}for(var a=[],i=0;i<LogicManager.MAP_COL;i++){a.push(i);for(var s=0;s<LogicManager.MAP_ROW;s++){var o=e.mapItemList[s][i];if(1!=o.state){a.splice(-1);break}}}t.length>0&&e.cleanMapItemList(0,t),a.length>0&&e.cleanMapItemList(1,a)},t.prototype.cleanMapItemList=function(e,t){for(var r=this,n=0==e?LogicManager.MAP_ROW:LogicManager.MAP_COL,o=0;o<t.length;o++)for(var a=0;n>a;a++){var i=0==e?t[o]:a,s=0==e?a:t[o];r.updataMapItem(i,s,0),LogicManager.getInstance.score++}},t.prototype.cleanMapItem=function(e){for(var t=this,r=0;r<e.length;r++)t.updataMapItem(e[r][0],e[r][1],0)},t.prototype.updataMapItem=function(e,t,r,n){void 0===n&&(n=1);var o=this,a=o.mapItemList[e][t];a.setIconType(n,r)},t.prototype.checkCanShadow=function(){var e=this;return LogicManager.getInstance.outOfMap(e.moveItem)?!1:e.checkOverlap()?!1:!0},t.prototype.checkOverlap=function(){for(var e=this,t=0;t<LogicManager.MAP_ROW;t++)for(var r=0;r<LogicManager.MAP_COL;r++){var n=e.mapItemList[t][r];if(1==n.state&&e.checkOverlap2(n))return!0}return!1},t.prototype.checkOverlap2=function(e){for(var t=this,r=t.moveItem.itemList.length,n=0;r>n;n++)for(var o=t.moveItem.itemList[n].length,a=0;o>a;a++){var i=t.moveItem.itemList[n][a];if(LogicManager.getInstance.inTouchArea(i.x+t.moveItem.x,i.y+t.moveItem.y,i.width,i.height,e))return!0}return!1},t.prototype.checkMapItem=function(e,t){var r=this;if(r.checkCanShadow())for(var n=e.itemList.length,o=0;n>o;o++)for(var a=e.itemList[o].length,i=0;a>i;i++){var s=e.itemList[o][i];if(LogicManager.getInstance.inTouchArea(s.x+e.x,s.y+e.y,s.width,s.height,t))return void r.updataMapItem(t.row,t.col,2,s.iconColor)}2==t.state&&r.updataMapItem(t.row,t.col,0)},t.prototype.touchBeginHandler=function(e){var t=this;t.chooseItem=e.currentTarget.getChildAt(0),1!=t.chooseItem.state&&t.chooseItem.canUse&&(e.currentTarget.getChildAt(0).visible=!1,t.moveItem.creatShape(t.chooseItem.myShape,t.chooseItem.ranColor),t.moveItem.x=t.chooseItem.x+e.currentTarget.x-t.mapGroup.x,t.moveItem.y=500,t.initOffset(e.stageX,e.stageY),t.moveItem.visible=!0)},t.prototype.initOffset=function(e,t){this.offSetX=e-this.moveItem.x,this.offSetY=t-this.moveItem.y},t.prototype.initHarmmerOffset=function(e,t){this.offSetX1=e-this.hammer.x,this.offSetY1=t-this.hammer.y},t.prototype.touchMoveHandler=function(e){var t=this,r=e.stageX,n=e.stageY;t.moveItem.visible&&(t.moveItem.x=r-t.offSetX,t.moveItem.y=n-t.offSetY,t.updataMap()),t.hammer.visible&&(t.hammer.x=r-t.offSetX1,t.hammer.y=n-t.offSetY1,t.checkHammerMapItem(t.findItemByHammer()))},t.prototype.touchEndHandler=function(){var e=this;if(e.hammer.visible)return e.hammerRelease(),e.hammer.visible=!1,void e.updataTetrisFilter();if(e.moveItem.visible){e.moveItem.visible=!1,e.touchEndMapItem()&&(e.chooseItem.state=1);for(var t=1;t<=LogicManager.RANDOM_COUNT;t++){var r=e["ranGroup"+t].getChildAt(0);e["ranGroup"+t].getChildAt(0).visible=0==r.state}e.rebuildRanGroup(),e.checkMapBlock(),e.scoreLabel.text=LogicManager.getInstance.score+"",e.canContinue()||MessageManger.getInstance.showText("没有可以放入的"),e.updataTetrisFilter()}},t.prototype.rebuildRanGroup=function(){for(var e=this,t=1;t<=LogicManager.RANDOM_COUNT;t++){var r=e["ranGroup"+t].getChildAt(0);if(0==r.state)return}e.randomTetrisItem(),e.updataTetrisFilter()},t.prototype.canContinue=function(){for(var e=this,t=!1,r=1;r<=LogicManager.RANDOM_COUNT;r++){var n=e["ranGroup"+r].getChildAt(0);if(0==n.state&&e.checkItemAddMap(n))return!0}return t},t.prototype.checkItemAddMap=function(e){for(var t=this,r=0;r<LogicManager.MAP_ROW;r++){if(r>LogicManager.MAP_ROW-e.myShape.length)return!1;for(var n=0;n<LogicManager.MAP_COL&&!(n>LogicManager.MAP_COL-e.myShape[0].length);n++)if(t.checkMatchShape(r,n,e))return!0}return!1},t.prototype.updataTetrisFilter=function(){for(var e=this,t=1;t<=LogicManager.RANDOM_COUNT;t++){var r=e["ranGroup"+t].getChildAt(0);r.canUse=0==r.state&&e.checkItemAddMap(r)}},t.prototype.checkMatchShape=function(e,t,r){for(var n=this,o=!0,a=0;a<r.myShape.length;a++)for(var i=0;i<r.myShape[a].length;i++){var s=n.mapItemList[a+e][i+t];if(1==r.myShape[a][i]&&1==s.state)return!1}return o},t.prototype.restartHandler=function(){var e=this;e.clearMap(),e.randomTetrisItem(),LogicManager.getInstance.score=0,LogicManager.getInstance.hammerTimes=LogicManager.HAMMER_TIMES,LogicManager.getInstance.refreshTimes=LogicManager.REFRESH_TIMES,e.hammerLabel.text=LogicManager.getInstance.hammerTimes+"",e.scoreLabel.text=LogicManager.getInstance.score+"",e.refreshLabel.text=LogicManager.getInstance.refreshTimes+""},t.prototype.destroyBtnHandler=function(e){var t=this;LogicManager.getInstance.hammerTimes>0?(t.hammer.visible=!0,t.hammer.x=e.stageX-t.mapGroup.x,t.hammer.y=600,t.initHarmmerOffset(e.stageX,e.stageY)):MessageManger.getInstance.showText("锤子已经使用完")},t.prototype.refreshBtnHandler=function(){var e=this;LogicManager.getInstance.refreshTimes>0?(LogicManager.getInstance.refreshTimes--,e.refreshLabel.text=LogicManager.getInstance.refreshTimes+"",e.randomTetrisItem(),e.updataTetrisFilter()):MessageManger.getInstance.showText("刷新已经使用完")},t.prototype.hammerRelease=function(){var e=this;if(e.destroyPos){for(var t=0,r=e.destroyPos.row-LogicManager.HAMMER_AREA;r<=e.destroyPos.row+LogicManager.HAMMER_AREA;r++)for(var n=e.destroyPos.col-LogicManager.HAMMER_AREA;n<=e.destroyPos.col+LogicManager.HAMMER_AREA;n++)if(LogicManager.getInstance.betweenTwoNumber(r,0,LogicManager.MAP_ROW-1)&&LogicManager.getInstance.betweenTwoNumber(n,0,LogicManager.MAP_COL-1)){var o=e.mapItemList[r][n];1==o.state&&t++,e.updataMapItem(r,n,0)}t>0&&(LogicManager.getInstance.hammerTimes--,e.hammerLabel.text=LogicManager.getInstance.hammerTimes+"")}},t.prototype.clearMap=function(){for(var e=this,t=0;t<LogicManager.MAP_ROW;t++)for(var r=0;r<LogicManager.MAP_COL;r++){var n=e.mapItemList[t][r];n.setIconType(1,0)}},t.prototype.createMap=function(){var e=this;e.mapItemList=[];for(var t=0;t<LogicManager.MAP_ROW;t++){for(var r=[],n=0;n<LogicManager.MAP_COL;n++){var o=new MapItem(t,n);o.x=n*o.width,o.y=t*o.height,e.mapGroup.addChild(o),r.push(o)}e.mapItemList.push(r)}},t.prototype.randomTetrisItem=function(){var e=this;DisplayUtils.removeAllChildren(e.ranGroup1),DisplayUtils.removeAllChildren(e.ranGroup2),DisplayUtils.removeAllChildren(e.ranGroup3);for(var t=1;t<=LogicManager.RANDOM_COUNT;t++){var r=new TetrisItem;r.scaleX=r.scaleY=.5,e["ranGroup"+t].addChild(r)}},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t}(UI.BaseScene);__reflect(GameMainView.prototype,"GameMainView");var PlayerInfoManager=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t,"getInstance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.setup=function(){},t}(egret.EventDispatcher);__reflect(PlayerInfoManager.prototype,"PlayerInfoManager");var App=function(){function e(){}return Object.defineProperty(e,"TimerManager",{get:function(){return TimerManager.Instance()},enumerable:!0,configurable:!0}),e}();__reflect(App.prototype,"App");var GameConfig=function(){function e(){}return e.systemType=function(){var e=window.navigator.userAgent.toLowerCase();""+e.match(/MicroMessenger/i);return""+e.match(/windows nt/i)=="windows nt"?"windows":""+e.match(/iphone/i)=="iphone"?"ios":""+e.match(/android/i)=="android"?"android":""+e.match(/ipad/i)=="ipad"?"ipad":""+e.match(/linux/i)=="linux"?"linux":""+e.match(/mac/i)=="mac"?"mac":""+e.match(/ucbrower/i)=="ucbrower"?"ucbrower":void LogManager.logFormat("未知系统类型")},e.platformType=function(){var e=window.navigator.userAgent.toLowerCase();return""+e.match(/micromessenger/i)=="micromessenger"?"micromessenger":""+e.match(/qzone/i)=="qzone"?"qzone":""+e.match(/weibo/i)=="weibo"?"weibo":""+e.match(/qq/i)=="qq"?"qq":""+e.match(/renren/i)=="renren"?"renren":""+e.match(/txmicroblog/i)=="txmicroblog"?"txmicroblog":""+e.match(/douban/i)=="douban"?"douban":"other"},e.IsIos=function(){return"wx"==ext.getPlatform()&&-1!=String(e.systemInfo.model).indexOf("iPhone")},e.IsIphoneX=function(){return"wx"==ext.getPlatform()&&(-1!=String(e.systemInfo.model).indexOf("iPhone X")||-1!=String(e.systemInfo.model).indexOf("LLD-AL20")||-1!=String(e.systemInfo.model).indexOf("iPhone11"))},e.IsWX=function(){return"wx"==ext.getPlatform()},e.Language="CN",e.Version="20180414",e.IsOnLine=navigator.onLine,e.IsDebug=!1,e}();__reflect(GameConfig.prototype,"GameConfig");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,r){function n(n){t.call(r,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var BoneAnimation=function(e){function t(r){var n=e.call(this)||this;return n._isLoadComplete=!1,n._isInPool=!1,n._timeScale=1,n._currentAnimationName="",n._isPauseAtLastFrame=!1,n._removeAtLastFrame=!0,n._removeWhenRemoveFromStage=!0,n._playTimes=1,n._detectFrameEvent=!1,n._direction=1,n._startframeIndex=0,n._param="",n._skeName=r,n._skeName==t.traceID&&LogManager.logFormat("LoadBone constructor {0}",t.traceID),n}return __extends(t,e),t.prototype.play=function(e,r){void 0===e&&(e=null),void 0===r&&(r=null),this._skeName==t.traceID&&LogManager.logFormat("LoadBone play {0}",t.traceID),this._complete=e,this._completeTarget=r,this.addEventListener(t.LOAD_COMPLETE,this.playNow,this),this._isLoadComplete&&this.playNow()},t.prototype.stop=function(e){null!=this.armature&&this.armature.animation.stop(e)},t.prototype.playNow=function(){this._skeName==t.traceID&&LogManager.logFormat("LoadBone playNow {0}",t.traceID),this._isInPool&&LogManager.warningFormat("{0} current is in pool must be not play",this._skeName),this.removeEventListener(t.LOAD_COMPLETE,this.playNow,this),""==this._currentAnimationName&&(this._currentAnimationName=this.getRandomAnimationName()),dragonBones.WorldClock.clock.add(this.armature),this.armature.animation.gotoAndPlayByFrame(this._currentAnimationName,this._startframeIndex,this.playTimes),this.armature.eventDispatcher.addDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.playComplete,this),this.detectFrameEvent&&this.armature.eventDispatcher.addDBEventListener(dragonBones.EventObject.FRAME_EVENT,this.onFrameEventFired,this),this.removeWhenRemoveFromStage&&this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onBoneRemove,this)},t.prototype.load=function(){this._skeName==t.traceID&&LogManager.logFormat("LoadBone load start {0}",t.traceID),ResUtil.getInstance.loadGroup(this._skeName,this.loadComplete,this,ResUtil.PRIORITY_H)},t.prototype.onFrameEventFired=function(e){this.dispatchEvent(new egret.Event(t.FRAME_EVENT,!0,!0,e.data))},t.prototype.loadComplete=function(){this._skeName==t.traceID&&LogManager.logFormat("LoadBone loadComplete start {0}",t.traceID),this.armature=BoneManager.Instance.getArmature(this._skeName),this._isLoadComplete=!0,this.addChild(this.armature.display),this.initBone(),this.dispatchEvent(new egret.Event(t.LOAD_COMPLETE,!0,!0,this)),this._skeName==t.traceID&&LogManager.logFormat("LoadBone loadComplete createComplete {0}",t.traceID)},t.prototype.resetForPool=function(){this._skeName==t.traceID&&LogManager.logFormat("LoadBone resetForPool {0}",t.traceID),this._isInPool=!0,this._isLoadComplete&&(this.armature.animation.stop(),this.armature.animation.timeScale=this._timeScale=1,this.armature.display.scaleX=this._direction=1,dragonBones.WorldClock.clock.remove(this.armature),DisplayUtils.resetDisplay(this),DisplayUtils.resetDisplay(this.armature.display))},t.prototype.playComplete=function(){this._skeName==t.traceID&&LogManager.logFormat("LoadBone playComplete {0}",t.traceID),this.armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.playComplete,this),this.isPauseAtLastFrame&&this.armature.animation.stop(this._currentAnimationName),this.removeAtLastFrame&&this.onBoneRemove(),null!=this._complete&&null!=this._completeTarget&&this._complete.call(this._completeTarget),this.dispatchEvent(new egret.Event(t.LOOP_COMPLETE,!0,!0,this))},t.prototype.onBoneRemove=function(){this._skeName==t.traceID&&LogManager.logFormat("LoadBone onBoneRemove {0}",t.traceID),this.armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.playComplete,this),this.armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.FRAME_EVENT,this.onFrameEventFired,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onBoneRemove,this),ResourcePool.getIntance().hasItem(this,ResourcePool.SKE)||ResourcePool.getIntance().push(this,ResourcePool.SKE)},t.prototype.initBone=function(){this._skeName==t.traceID&&LogManager.logFormat("LoadBone initBone {0}",t.traceID),this._isInPool=!1,this._isLoadComplete&&(this.armature.animation.timeScale=this._timeScale),this._isLoadComplete&&(this.armature.display.scaleX=this._direction),this._positionString&&(this.position=this.position)},t.prototype.gotoAndStopFrame=function(e){void 0===e&&(e=""),this._skeName==t.traceID&&LogManager.logFormat("LoadBone playNow {0}",t.traceID),this._currentAnimationName=e,""==this._currentAnimationName&&(this._currentAnimationName=this.getRandomAnimationName()),this.armature.animation.gotoAndStopByFrame(this._currentAnimationName)},t.prototype.gotoAndStopFrameExcept=function(e){this._skeName==t.traceID&&LogManager.logFormat("LoadBone playNow {0}",t.traceID),this._currentAnimationName=this.getRandomAnimationNameExcept(e),this.armature.animation.gotoAndStopByFrame(this._currentAnimationName)},Object.defineProperty(t.prototype,"skeName",{get:function(){return this._skeName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoadComplete",{get:function(){return this._isLoadComplete},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeScale",{get:function(){return this._timeScale},set:function(e){this._timeScale=e,this._isLoadComplete&&(this.armature.animation.timeScale=this._timeScale)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentAnimationName",{get:function(){return this._currentAnimationName},set:function(e){this._currentAnimationName=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playTimes",{get:function(){return this._playTimes},set:function(e){this._playTimes=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"detectFrameEvent",{get:function(){return this._detectFrameEvent},set:function(e){this._detectFrameEvent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"removeAtLastFrame",{get:function(){return this._removeAtLastFrame},set:function(e){this._removeAtLastFrame=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPauseAtLastFrame",{get:function(){return this._isPauseAtLastFrame},set:function(e){this._isPauseAtLastFrame=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"removeWhenRemoveFromStage",{get:function(){return this._removeWhenRemoveFromStage},set:function(e){this._removeWhenRemoveFromStage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(e){this._direction=e,this._isLoadComplete&&(this.armature.display.scaleX=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positionString",{get:function(){return this._positionString},set:function(e){if(""!=e){var t=e.split("|");if(2==t.length){this._positionString=e;var r=new egret.Point(Number(t[0]),Number(t[1]));this.position=r}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e,this.x=this._position.x,this.y=this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startframeIndex",{get:function(){return this._startframeIndex},set:function(e){this._startframeIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"param",{get:function(){return this._param},set:function(e){this._param=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"param1",{get:function(){return this._param1},set:function(e){this._param1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allAnimationNames",{get:function(){return this.armature.animation.animationNames},enumerable:!0,configurable:!0}),t.prototype.hasAnimation=function(e){return null==this.armature?!1:this.armature.animation.hasAnimation(e)},t.prototype.getFrameCountByName=function(e){var t=this.armature.animation.animations[e];return t.frameCount},t.prototype.getRandomAnimationName=function(){return 1==this.allAnimationNames.length?this.allAnimationNames[0]:ObjectUtils.getRandomItem(this.allAnimationNames)},t.prototype.getRandomAnimationNameExcept=function(e){if(1==this.allAnimationNames.length)return this.allAnimationNames[0];var t=this.allAnimationNames.slice(1);return ObjectUtils.getRandomItem(t)},t.prototype.dispose=function(){this._skeName==t.traceID&&LogManager.logFormat("LoadBone dispose {0}",t.traceID),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onBoneRemove,this),this.armature&&(this.armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.playComplete,this),this.armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.FRAME_EVENT,this.onFrameEventFired,this),dragonBones.WorldClock.clock.remove(this.armature),this.armature.dispose(),this.armature=null),this._skeName=null,this._complete=null,this._completeTarget=null,this._position=null,this._currentAnimationName=null,this._isPauseAtLastFrame=null,this._removeAtLastFrame=null},t.LOAD_COMPLETE="boneLoadComplete",t.LOOP_COMPLETE="boneLoopComplete",t.FRAME_EVENT="frameEvent",t.traceID="tx_01",t}(egret.Sprite);__reflect(BoneAnimation.prototype,"BoneAnimation");var BoneConfig=function(){function e(){}return e.copyValueFromTemplate=function(e,t){var r=GlobleData.getDataByFilter(GlobleData.BoneAnimationVO,"skename",t);if(r.length>0){var n=r[0];ObjectUtils.copyValue(e,n)}},e.SKE_END_TAG="_ske_json",e.TEXTUREDATA_END_TAG="_tex_json",e.TEXTURE_END_TAG="_tex_png",e}();__reflect(BoneConfig.prototype,"BoneConfig");var BoneManager=function(){function e(){this._factory=dragonBones.EgretFactory.factory}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.test_showBone=function(e){var t=ResourcePool.getIntance().pop(e,ResourcePool.SKE);DisplayUtils.addToStageCenter(t,!0),t.playTimes=0,t.removeAtLastFrame=!1,t.play()},e.prototype.start=function(){App.TimerManager.doFrame(0,0,this.onUpdate,this)},e.prototype.stop=function(){App.TimerManager.remove(this.onUpdate,this)},e.prototype.onUpdate=function(e){dragonBones.WorldClock.clock.advanceTime(-1)},e.prototype.getArmature=function(e){if(null==this._factory.getDragonBonesData(e)){var t=this.getSkeData(e),r=this.getTextureData(e),n=this.getTexture(e);this._factory.parseDragonBonesData(t),this._factory.parseTextureAtlasData(r,n)}var o=this._factory.buildArmature(e);
return o},e.prototype.getSkeData=function(e){return RES.getRes(e+BoneConfig.SKE_END_TAG)},e.prototype.getTextureData=function(e){return RES.getRes(e+BoneConfig.TEXTUREDATA_END_TAG)},e.prototype.getTexture=function(e){return RES.getRes(e+BoneConfig.TEXTURE_END_TAG)},e}();__reflect(BoneManager.prototype,"BoneManager");var Command=function(){function e(){}return e.prototype.Command=function(){this._isFinished=!1},e.prototype.connect=function(e){return!1},e.prototype.canReplace=function(e){return!1},Object.defineProperty(e.prototype,"isFinished",{get:function(){return this._isFinished},enumerable:!0,configurable:!0}),e.prototype.prepare=function(){this._isPrepare||(this._isPrepare=!0)},e.prototype.execute=function(){this.executeAtOnce(),this._isFinished=!0},e.prototype.executeAtOnce=function(){this.prepare(),this._isFinished=!0},e.prototype.cancel=function(){},e}();__reflect(Command.prototype,"Command");var CommandQueue=function(){function e(){this._queue=new Array}return e.prototype.add=function(e){for(var t=0;t<this._queue.length;t++){var r=this._queue[t];if(r.connect(e))return;if(r.canReplace(e))return e.prepare(),void(this._queue[t]=e)}this._queue.push(e),1==this._queue.length&&e.prepare()},e.prototype.execute=function(){if(this._queue.length>0){var e=this._queue[0];e.isFinished?(this._queue.shift(),this._queue.length>0&&this._queue[0].prepare()):e.execute()}},e.prototype.traceAllRemainAction=function(){for(var e=0;e<this._queue.length;e++){var t=egret.getQualifiedClassName(this._queue[e]);LogManager.logFormat("【Command】"+t)}},Object.defineProperty(e.prototype,"actionCount",{get:function(){return this._queue.length},enumerable:!0,configurable:!0}),e.prototype.executeAtOnce=function(){for(var e=0;e<this._queue.length;e++)this._queue[e].executeAtOnce()},e.prototype.clear=function(){for(var e=0;e<this._queue.length;e++)this._queue[e].cancel();this._queue=[]},e}();__reflect(CommandQueue.prototype,"CommandQueue");var EventsManager=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t,"getInstance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}(egret.EventDispatcher);__reflect(EventsManager.prototype,"EventsManager");var GameEnterManager=function(){function e(){}return e.prototype.setup=function(){PlayerInfoManager.getInstance.setup(),LogicManager.getInstance.setup()},Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e}();__reflect(GameEnterManager.prototype,"GameEnterManager");var GlobleData=function(e){function t(){var t=e.call(this)||this;return t._hasParasComplete=!1,t._totalStepCsvList=new TSDictionary,t._needParseCount=0,t._currParseCount=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"hasParasComplete",{get:function(){return this._hasParasComplete},enumerable:!0,configurable:!0}),t.prototype.setup=function(e){var t=this;t._callback=e,t.initModel(),t.initStep()},t.prototype.initModel=function(){var e=this;e._totalStepCsvList.Add(t.ServerConfigVO,ServerConfigVO)},t.prototype.initStep=function(){var e=this;e._needParseCount=e._totalStepCsvList.GetLenght(),RES.getResAsync("json_zip",this.onloadDataComplete,e),LogManager.logFormat("dataFile is json_zip")},t.prototype.onloadDataComplete=function(e,t){var r=this;r._csvZipData=new JSZip(e),LogManager.logFormat("onloadDataComplete is json_zip:"+t),App.TimerManager.doFrame(0,0,r.onEnterFrameLoader,r)},t.prototype.onEnterFrameLoader=function(){var e=this;e._currParseCount>=e._needParseCount?(App.TimerManager.remove(e.onEnterFrameLoader,e),this._hasParasComplete=!0,GameEnterManager.Instance.setup(),e._callback&&e._callback()):(e.getCsvFile(),e.getCsvFile())},t.prototype.getCsvFile=function(){var e=this;if(e._currParseCount<e._needParseCount){var t=e._totalStepCsvList.getKeyByIndex(e._currParseCount);t=t.replace("_",".");var r=e._csvZipData.file(t);null==r&&LogManager.errorFormat("can't get key from key :"+t);var n=e._csvZipData.file(t).asText();e.starSingleParse(n)}},t.prototype.starSingleParse=function(e){var r=this,n=r._totalStepCsvList.getKeyByIndex(r._currParseCount),o=r._totalStepCsvList.getValueByIndex(r._currParseCount),a=CSVParser.ParseJsonData(o,e);t.AllCacheData.Add(n,a),r._currParseCount++},Object.defineProperty(t,"getInstance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.getData=function(e,r){var n=t.AllCacheData.TryGetValue(e);return n?n.TryGetValue(r):[]},t.getDataByFilter=function(e,r,n){var o=t.AllCacheData.TryGetValue(e);if(!o)return[];var a=o.TryGetListByCondition(function(e){return e[r]==n});return a},t.getAllValue=function(e){var r=t.AllCacheData.TryGetValue(e);return r?r.getValues():[]},t.getDataByCondition=function(e,r){var n=t.AllCacheData.TryGetValue(e);if(!n)return[];var o=n.TryGetListByCondition(r);return o},t.AllCacheData=new TSDictionary,t.ServerConfigVO="ServerConfig_json",t.SoundVO="Sound_json",t.BoneAnimationVO="BoneAnimation_json",t}(egret.DisplayObject);__reflect(GlobleData.prototype,"GlobleData");var LanguageManager=function(){function e(){this._languageMap=new TSDictionary,this._reg=new RegExp("\\{(\\d+)\\}")}return Object.defineProperty(e,"getInstance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.setup=function(e){var t=this,r=String(e).split("\r\n");if(r.length)for(var n=0;n<r.length;n++){var o=r[n];if("#"!=o&&""!=o){var a=o.split(":");t._languageMap.ContainsKey(a[0])&&t._languageMap.Remove(a[0]),a.length<=2?t._languageMap.Add(a[0],a[1]):t._languageMap.Add(a[0],a.slice(1).join(""))}}},e.prototype.getLanguageMapData=function(){var e=this;return e._languageMap.getValues()},e.prototype.getLanguageById=function(e){var t=this;return t._languageMap.TryGetValue(e)},e.prototype.setModuleLanguage=function(t){var r=this;t&&(!t||t.numChildren)&&e.isOpenLanguage&&r.SearchAndModifyNodeLanguage(t)},e.prototype.SearchAndModifyNodeLanguage=function(t){for(var r=0;r<t.numChildren;r++){var n=t.getChildAt(r);if(n instanceof egret.DisplayObjectContainer&&this.SearchAndModifyNodeLanguage(n),n instanceof eui.Label){if(""!=n.name){var o=n.name.split("@")[1];o&&(n.text=e.getInstance.getLanguageById(o))}}else if(n instanceof eui.EditableText){if(""!=n.name){var o=n.name.split("@")[1];o&&(n.prompt=e.getInstance.getLanguageById(o))}}else if(n instanceof eui.Button&&""!=n.name){var o=n.name.split("@")[1];o&&(n.label=e.getInstance.getLanguageById(o))}}},e.prototype.getLanguageText=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this;return n.getTranslationWithArray(e,t)},e.prototype.getTranslationWithArray=function(e,t){var r=this;return r._languageMap.ContainsKey(e)?r.replaceStr(r._languageMap.TryGetValue(e),t):void 0},e.prototype.languageReplace=function(e,t){var r=this;return r.replaceStr(e,t)},e.prototype.replaceStr=function(e,t){var r=this;if(t&&t.length>0)for(var n=r._reg.exec(e);n&&t.length>0;){var o=Number(n[1]),a=String(t[o]);if(o>=0&&o<t.length){var i=a.indexOf("$");i>-1&&(a=a.slice(0,i)+"$"+a.slice(i)),e=e.replace(r._reg,a)}else e=e.replace(r._reg,"{}");n=r._reg.exec(e)}return e},e.isOpenLanguage=!0,e}();__reflect(LanguageManager.prototype,"LanguageManager");var LoginManager=function(){function e(){}return e.prototype.setup=function(){},Object.defineProperty(e,"getInstance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}();__reflect(LoginManager.prototype,"LoginManager");var LogManager=function(){function e(){}return e.logFormat=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.buildFormatString(t,r);egret.log(o)},e.warningFormat=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.buildFormatString(t,r);egret.warn(o)},e.errorFormat=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.buildFormatString(t,r);egret.error(o)},e.buildFormatString=function(e,t){var r;return"number"==typeof e?r=e.toString():"string"==typeof e?r=e:"object"==typeof e&&(r=JSON.stringify(e)),t.forEach(function(e,t){r=r.replace("{"+t+"}",e)}),r+=" -- [Time:"+egret.getTimer()+"]"},e.format=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(t,r){e=e.replace("{"+r+"}",t)}),e},e}();__reflect(LogManager.prototype,"LogManager");var MessageManger=function(){function e(){this._textDisplayDic=new TSDictionary,this._maxNum=5}return Object.defineProperty(e,"getInstance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype._creatOneTextDisplay=function(){var e=new eui.Label;return e.textColor=16777215,e.stroke=3,e.strokeColor=4199171,e.size=40,e.fontFamily="黑体",e.horizontalCenter=0,e.verticalCenter=0,e.touchEnabled=!1,e.width=StageUtils.getInstance.stage.stageWidth,e.wordWrap=!0,e.textAlign="center",e.y=StageUtils.getInstance.stage.stageHeight/2,e},e.prototype.showText=function(e){var t=this,r=this.getOne(e);r.text=e;var n={display:r,isplaying:!0};this._textDisplayDic.Add(e,n),LayerManager.getInstance.addToLayer(r,LayerManager.GAME_POP_LAYER),r.alpha=1,egret.Tween.get(r).to({verticalCenter:-100},3e3).call(function(){egret.Tween.removeTweens(r),r.parent&&r.parent.removeChild(r),r.alpha=1,r.verticalCenter=0,t.onAnimationComplete(e)})},e.prototype.startAnimation=function(e,t){var r=this;LayerManager.getInstance.addToLayer(t,LayerManager.GAME_POP_LAYER),t.alpha=1,egret.Tween.get(t).to({verticalCenter:-100},3e3).call(function(){egret.Tween.removeTweens(t),t.parent&&t.parent.removeChild(t),t.alpha=1,t.verticalCenter=0,delete t.$children,r.onAnimationComplete(e)})},e.prototype.onAnimationComplete=function(e){var t=this._textDisplayDic.TryGetValue(e);t&&(t.isplaying=!1,this._textDisplayDic.Remove(e))},e.prototype.removeTips=function(){for(var e=this,t=0;t<e._textDisplayDic.GetLenght();t++){var r=e._textDisplayDic.getValueByIndex(t);r.display.parent&&r.display.parent.removeChild(r.display),r.display.alpha=1,r.display.verticalCenter=0,delete r.display.$children}e._textDisplayDic.clear()},e.prototype.getOne=function(e){return this._creatOneTextDisplay()},e}();__reflect(MessageManger.prototype,"MessageManger");var PathManager=function(){function e(){this._resourceUrl=""}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resourceUrl",{get:function(){var e=this;return e._resourceUrl},set:function(e){var t=this;t._resourceUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ThemePath",{get:function(){var e=this;return e._resourceUrl+"default.thm.json"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MapBackgoundPath",{get:function(){var e=this;return e._resourceUrl+"Common/map/{0}.jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EquipPath",{get:function(){var e=this;return e._resourceUrl+"Common/equip/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MercenaryPath",{get:function(){var e=this;return e._resourceUrl+"Common/mercenarys/mercenary/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SevenDayPath",{get:function(){var e=this;return e._resourceUrl+"Common/sevenDay/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MercenaryLargePath",{get:function(){var e=this;return e._resourceUrl+"Common/mercenarys/drawing/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Mercenary_Small_Path",{get:function(){var e=this;return e._resourceUrl+"Common/mercenarys/mercenary_small/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeroSkill_Path",{get:function(){var e=this;return e._resourceUrl+"Common/skill/heroSk_{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Hero_Path",{get:function(){var e=this;return e._resourceUrl+"Common/heroes/big/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeroGoldBody_Path",{get:function(){var e=this;return e._resourceUrl+"Common/heroes/gb/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeroSkin_Path",{get:function(){var e=this;return e._resourceUrl+"Common/heroes/skin/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeroSmallSkin_Path",{get:function(){var e=this;return e._resourceUrl+"Common/heroes/smallSkin/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Ancient_Path",{get:function(){var e=this;return e._resourceUrl+"Common/ancient/ancientIcon_{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkillPath",{get:function(){var e=this;return e._resourceUrl+"Common/skill/heroSk_{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemPath",{get:function(){var e=this;return e._resourceUrl+"Common/item/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SoundPath",{get:function(){var e=this;return e._resourceUrl+"Common/sound/"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Shop",{get:function(){var e=this;return e._resourceUrl+"Common/shop/{0}.png"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Share",{get:function(){var e=this;return e._resourceUrl+"Common/share/{0}.jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"language_path",{get:function(){var e=this;return e._resourceUrl+"/config/language.txt"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ConfigUrls",{get:function(){var e=this;return[e._resourceUrl+"default.res.json",e._resourceUrl+"config/game_com.res.json",e._resourceUrl+"config/game_ui.res.json"]},enumerable:!0,configurable:!0}),e}();__reflect(PathManager.prototype,"PathManager");var SdkManager=function(){function e(){}return Object.defineProperty(e,"getInstance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.paySdk=function(e){},e.prototype.payFail=function(){MessageManger.getInstance.showText(LanguageManager.getInstance.getLanguageText("models.sdkManager.payFail"))},e.prototype.totalShare=function(e,t,r){void 0===r&&(r=null)},e.prototype.getFriendList=function(e,t){},e.prototype.createRank=function(){},e.prototype.getSystemInfo=function(){},e.prototype.setUserCloudStorage=function(e){},e.prototype.ShowVideoAd=function(e,t){},e.prototype.addShortcut=function(e){},e}();__reflect(SdkManager.prototype,"SdkManager");var SoundManager=function(){function e(){}return e.playEffect=function(e){var t=this;t.gameVoice&&t.loaderEffectSound(e)},e.playBattleEffect=function(e){var t=this;t.battleSound&&t.loaderEffectSound(e)},e.loaderEffectSound=function(t){return __awaiter(this,void 0,void 0,function(){var r,n;return __generator(this,function(o){return r=this,0==r.ALL_SOUND?[2]:(n=GlobleData.getData(GlobleData.SoundVO,t),null==n?[2]:(null==RES.getRes(PathManager.Instance.SoundPath+n.file)?ResUtil.getInstance.loadAsyncSound(n.file,function(){e.createEffectSound(n)}):e.createEffectSound(n),[2]))})})},e.createEffectSound=function(e){var t=RES.getRes(PathManager.Instance.SoundPath+e.file);if(t){t.type=egret.Sound.EFFECT;var r=t.play(0,e.loop);r.addEventListener(egret.Event.SOUND_COMPLETE,function(){},this),r.volume=e.volume}},e.playBgSound=function(e,t){void 0===t&&(t=!0);var r=this;r.loaderBGSound(e,t)},e.loaderBGSound=function(t,r){return void 0===r&&(r=!0),__awaiter(this,void 0,void 0,function(){var n,o;return __generator(this,function(a){return n=this,o=GlobleData.getData(GlobleData.SoundVO,t),null==o?[2]:(null==RES.getRes(PathManager.Instance.SoundPath+o.file)?ResUtil.getInstance.loadAsyncSound(o.file,function(){e.createBgSound(o,r)}):e.createBgSound(o,r),[2])})})},e.createBgSound=function(t,r){void 0===r&&(r=!0);var n=this;n.sdbg=RES.getRes(PathManager.Instance.SoundPath+t.file),n.sdbg&&(n.sdbg.type=egret.Sound.MUSIC,e.stopBgSound(),n.soundChannel=n.sdbg.play(0,r?0:1),n.soundChannel.volume=t.volume)},e.stopBgSound=function(){var e=this;if(e.soundChannel){var t=e.soundChannel;t.stop(),e.soundChannel=null}},e.battleSound=!0,e.gameVoice=!0,e.ALL_SOUND=!0,e}();__reflect(SoundManager.prototype,"SoundManager");var TimerManager=function(e){function t(){var t=e.call(this)||this;return t._handlers=new Array,t._delHandlers=new Array,t._currTime=egret.getTimer(),t._currFrame=0,t._count=0,t._timeScale=1,egret.Ticker.getInstance().register(t.onEnterFrame,t),t}return __extends(t,e),t.prototype.setTimeScale=function(e){this._timeScale=e},t.prototype.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer();for(var e=0;e<this._count;e++){var t=this._handlers[e],r=t.userFrame?this._currFrame:this._currTime;r>=t.exeTime&&(t.method.call(t.methodObj,(this._currTime-t.dealTime)*this._timeScale),t.dealTime=this._currTime,t.exeTime+=t.delay,t.repeat||(t.repeatCount>1?t.repeatCount--:(t.complateMethod&&t.complateMethod.apply(t.complateMethodObj),this._delHandlers.push(t))))}for(;this._delHandlers.length;){var t=this._delHandlers.pop();this.remove(t.method,t.methodObj)}},t.prototype.create=function(e,t,r,n,o,a,i){if(!(0>t||0>r||null==n)){this.remove(n,o);var s=ObjectPool.pop("TimerHandler",TimerHandler);s.userFrame=e,s.repeat=0==r,s.repeatCount=r,s.delay=t,s.method=n,s.methodObj=o,s.complateMethod=a,s.complateMethodObj=i,s.exeTime=t+(e?this._currFrame:this._currTime),s.dealTime=this._currTime,this._handlers.push(s),this._count++}},t.prototype.doTimer=function(e,t,r,n,o,a){void 0===o&&(o=null),void 0===a&&(a=null),this.create(!1,e,t,r,n,o,a)},t.prototype.doFrame=function(e,t,r,n,o,a){void 0===o&&(o=null),void 0===a&&(a=null),this.create(!0,e,t,r,n,o,a)},Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),t.prototype.remove=function(e,t){for(var r=0;r<this._count;r++){var n=this._handlers[r];if(n.method==e&&n.methodObj==t){this._handlers.splice(r,1),ObjectPool.push(n),this._count--;break}}},t.prototype.removeAll=function(e){for(var t=0;t<this._count;t++){var r=this._handlers[t];r.methodObj==e&&(this._handlers.splice(t,1),ObjectPool.push(r),this._count--,t--)}},t.prototype.isExists=function(e,t){for(var r=0;r<this._count;r++){var n=this._handlers[r];if(n.method==e&&n.methodObj==t)return!0}return!1},t}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function e(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}return e.prototype.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},e}();__reflect(TimerHandler.prototype,"TimerHandler");var ByteSocket=function(e){function t(t,r){void 0===r&&(r=!1);var n=e.call(this)||this;n._m_PackageQueue=new Array;var o=n;return SocketConfig.DEBUG=r,o._readBuffer=new egret.ByteArray,o._headerTemp=new egret.ByteArray,o._encrypted=t,n}return __extends(t,e),t.prototype.setKey=function(e){var t=this;t.RECEIVE_KEY=new egret.ByteArray,t.SEND_KEY=new egret.ByteArray;for(var r=0;8>r;r++)t.RECEIVE_KEY.writeByte(e[r]),t.SEND_KEY.writeByte(e[r])},t.prototype.resetKey=function(){this.setKey(SocketConfig.KEY)},t.prototype.sendProtobuffer=function(e,t){var r=this;if(null!=t){var n=new egret.ByteArray(t);e.writeBytes(n,0,n.length)}r.send(e)},t.prototype.send=function(e){var t=this;if(t._socket&&t._socket.connected){if(e.pack(),t._encrypted){e.position=0,t.SEND_KEY.position=0;for(var r=void 0,n=void 0,o=void 0,a=void 0,i=void 0,s=new egret.ByteArray,c=new egret.ByteArray,u=new egret.ByteArray,p=0;p<e.length;p++)if(p>0){a=p,i=p%8,e.position=a,t.SEND_KEY.position=i;var l=o;p>=8?(c.position>=8&&u.length>0&&(c.clear(),c=t.copyByteArray(u),u.clear()),c.position=i,n=c.readByte(),n=n+l^p,u.writeByte(n)):(n=t.SEND_KEY.readByte(),n=n+l^p,c.writeByte(n)),r=e.readByte(),r=(r^n)+l,o=r,s.writeByte(r)}else r=e.readByte(),n=t.SEND_KEY.readByte(),r^=n,o=r,s.writeByte(r),c.writeByte(n);var h=new egret.ByteArray;for(u.length>0&&(h=t.copyByteArray(u)),c.position=u.position,p=c.position;p<c.length;p++)h.writeByte(c.readByte());t.SEND_KEY.clear(),t.SEND_KEY=t.copyByteArray(h),h.clear(),c.clear(),u.clear(),t._socket.writeBytes(s,0,s.length)}else e.position=0,t._socket.writeBytes(e,0,e.length);t._socket.flush()}},t.prototype.connect=function(e,t){var r=this;null!=r._socket&&r.close(),r._socket=new egret.WebSocket,r._socket.type=egret.WebSocket.TYPE_BINARY,SocketConfig.IP=e,SocketConfig.PORT=t,r._readBuffer.position=0,r._readOffset=0,r._writeOffset=0,r._socket.addEventListener(egret.Event.CONNECT,r.onConnectHandler,r),r._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,r.onErrorHandler,r),r._socket.addEventListener(egret.Event.CLOSE,r.onCloseHandler,r),r._socket.connectByUrl(e+":"+t+"/weegame")},t.prototype.onErrorHandler=function(e){LogManager.logFormat("连接错误");var t=this,r=new egret.Event(SocketEvents.SOCKET_ERROR);t.dispatchEvent(r)},t.prototype.onCloseHandler=function(){LogManager.logFormat("连接关闭");var e=this,t=new egret.Event(SocketEvents.SOCKET_CLOSE);e.dispatchEvent(t)},t.prototype.onConnectHandler=function(){var e=this;LogManager.logFormat("连接socket成功"),SocketManager.getInstance.onConnectHandler(null),e._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,e.onReceiveMessageHandler,e)},t.prototype.onReceiveMessageHandler=function(){var e=this;if(!e._socket.connected)return void e.close();var t=new egret.ByteArray;e._socket.readBytes(t);var r=t.length;if(r>0){var n=t;e._readBuffer.writeBytes(n,0,r),e._writeOffset+=r,e._writeOffset>1&&(e._readOffset=0,r>=PackageIn.HEADER_SIZE&&e.readPackage())}},t.prototype.readPackage=function(){var e=this,t=e._writeOffset-e._readOffset,r=e.copyByteArray(e._readBuffer);r.position=0;do{var n=0;for(e._readBuffer.position=e._readOffset;e._readOffset+4<e._writeOffset;){if(e._headerTemp.clear(),e._headerTemp.writeByte(e._readBuffer.readByte()),e._headerTemp.writeByte(e._readBuffer.readByte()),e._headerTemp.writeByte(e._readBuffer.readByte()),e._headerTemp.writeByte(e._readBuffer.readByte()),e._encrypted&&(e._headerTemp=e.decrptBytes(e._headerTemp,4,e.copyByteArray(e.RECEIVE_KEY))),e._headerTemp.position=0,e._headerTemp.readShort()==PackageOut.HEADER){n=e._headerTemp.readUnsignedShort();break}e._readOffset++}if(t=e._writeOffset-e._readOffset,!(t>=n&&0!=n))break;var o=new egret.ByteArray;e._readBuffer.position=e._readOffset;var a=0;for(a=0;t>a;a++)o.writeByte(r.readByte());var i=new PackageIn;e._encrypted?i.loadE(o,n,e.RECEIVE_KEY):i.load(o,n),e._readOffset+=n,t=e._writeOffset-e._readOffset,e.handlePackage(i)}while(t>=PackageIn.HEADER_SIZE);e._readBuffer.position=0,t>0&&e._readBuffer.writeBytes(e._readBuffer,e._readOffset,t),e._readOffset=0,e._writeOffset=t},t.prototype.handlePackage=function(e){var t=this;e.checksum==e.calculateCheckSum()&&(e.position=PackageIn.HEADER_SIZE,t._m_PackageQueue.push(e),t.onGetSocketData())},t.prototype.decrptBytes=function(e,t,r){var n=this,o=0,a=new egret.ByteArray;e.position=0,r.position=0;var i,s,c,u,p,l=new egret.ByteArray,h=new egret.ByteArray;for(o=0;t>o;o++)o>0?(u=o%8,r.position=u,o>=8?(l.position>=8&&h.length>0&&(l.clear(),l=n.copyByteArray(h),h.clear()),l.position=u,c=l.readByte(),c=c+s^o):(c=r.readByte(),c=c+s^o,l.writeByte(c)),i=e.readByte(),p=i-s^c,a.writeByte(p),s=i):(i=e.readByte(),c=r.readByte(),p=i^c,a.writeByte(p),l.writeByte(c),s=i);return a},t.prototype.copyByteArray=function(e){var t=new egret.ByteArray;e.position=0;for(var r=0;r<e.length;r++)t.writeByte(e.readByte());return t},t.prototype.onGetSocketData=function(){var e=this;if(e._m_PackageQueue.length>0)for(var t=0;t<SocketConfig.HANDLER_MAX;){if(e._m_PackageQueue.length<=0)return;t++;var r=e._m_PackageQueue.shift();e.dispatchEventWith(SocketEvents.SOCKET_DATA,!1,r)}},t.prototype.close=function(){var e=this;e._socket.connected&&e._socket.close(),e._socket=null},Object.defineProperty(t.prototype,"connected",{get:function(){var e=this;return e._socket.connected},enumerable:!0,configurable:!0}),t}(egret.EventDispatcher);__reflect(ByteSocket.prototype,"ByteSocket");var SocketManager=function(e){function t(){var t=e.call(this)||this;return t._hasInitEvents=!1,t}return __extends(t,e),t.prototype.setup=function(e,t){var r=this;r._socket=new ByteSocket(!1),r._socket.connect(e,t),r._out=new GameSocketOut(r),r.initEvents()},t.prototype.reConnect=function(e,t){var r=this;r._socket.connect(e,t)},t.prototype.initEvents=function(){var e=this;e._hasInitEvents||(e.addEventListener(SocketEvents.SOCKET_CONNECT,e.onConnectHandler,e),e._socket.addEventListener(SocketEvents.SOCKET_ERROR,e.onErrorHandler,e),e._socket.addEventListener(SocketEvents.SOCKET_CLOSE,e.onSocketCloseHandler,e),e._socket.addEventListener(SocketEvents.SOCKET_DATA,e.onSocketDataHandler,e),e._hasInitEvents=!0)},t.prototype.removeEvents=function(){var e=this;e._hasInitEvents=!1,e.removeEventListener(SocketEvents.SOCKET_CONNECT,e.onConnectHandler,e),e._socket.removeEventListener(SocketEvents.SOCKET_ERROR,e.onErrorHandler,e),e._socket.removeEventListener(SocketEvents.SOCKET_CLOSE,e.onSocketCloseHandler,e),e._socket.removeEventListener(SocketEvents.SOCKET_DATA,e.onSocketDataHandler,e)},t.prototype.onConnectHandler=function(e){var t=this;LogManager.logFormat("连接服务器成功"),t.removeEventListener(SocketEvents.SOCKET_CONNECT,t.onConnectHandler,t),this.dispatchEventWith(SocketEvents.SOCKET_CONNECT)},t.prototype.onSocketDataHandler=function(e){var t=this,r=e.data;if(null!=r){var n=r.code,o=r.readBody();t.dispatchEventWith(SocketEvents.format(n),!1,o.bytes)}},t.prototype.onSocketCloseHandler=function(){LogManager.logFormat("服务器没有连接上"),t.getInstance.close()},t.prototype.onErrorHandler=function(e){t.getInstance.close()},t.prototype.close=function(){var e=this;null!=e._socket&&e._socket.close()},Object.defineProperty(t.prototype,"socket",{get:function(){var e=this;return e._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"out",{get:function(){var e=this;return e._out},enumerable:!0,configurable:!0}),Object.defineProperty(t,"getInstance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}(egret.EventDispatcher);__reflect(SocketManager.prototype,"SocketManager");var PackageInTypeVo=function(){function e(){}return e.LANDFALL=6,e.LOGIN_SUCCESS=17,e.HEARTBEAT=11,e.PLAYER_MESSAGE=30,e.ACHIEVEMENTS_INIT=200,e.ACHIEVEMENTS_UPDATE=201,e.BAG_INIT=250,e.BAG_UPDATE=251,e.HEROES_LIST_MSG=37,e.HEROES_SKILL_LIST_MSG=118,e.HERO_MSG=38,e.EQUIP_ALL=42,e.EQUIP_ITEM=41,e.ANCIENT_LIST_MSG=39,e.ANCIENT_MSG=43,e.ANCIENT_RECOVER=46,e.REFRESH_BUY=40,e.RISKDATAMSG=106,e.REBIRTHDATA_LIST=107,e.MERCENARY_ON_LIST=300,e.MERCENARY_OUT_LIST=305,e.MERCENARY_DATA_LIST_NEW=303,e.MERCENARY_DATA_MSG=301,e.MERCENARY_DEVOUR=302,e.REWARD_LIST=15,e.DOUBLE_REWARD_LIST=49,e.HEROS_REWARD=108,e.ERROR_CODE=14,e.MAIL_LIST=8,e.MAIL_INFO=9,e.MAIL_DELETE=16,e.SKILL_LIST=44,e.SKILL_INFO=45,e.SKILL_SINGLE_CLEAR=50,e.MISSIONID_NEW=47,e.SKILL_CD_CLEAR=48,e.QUERY_TIMELAPSE_LIST=600,e.REVIVE=109,e.REVIVE_COMPLETE=117,e.CYCLE_HEROSOUL=601,e.HERO_Skin_LIST=110,e.HERO_GOLD_LIST=112,e.OFF_LINE_REWARD=111,e.UPDATA_SINGLE_SKIN=113,e.DAY_CHARGE=650,e.ACTIVITY_REWARD_STATE=651,e.DAY_SHARE=751,e.CONSUME_GIFT_BAG=655,e.CONSUME_BOX_LIST=656,e.MASCOT=702,e.CHECK_MASCOT_REWARD=704,e.SIGN_MSG=701,e.FIRST_RECHARGE=652,e.LOTTERY_REWARDS=753,e.LOTTERY_STATE_MSG=752,e.ACTIVITY_OPEN_LIST=750,e.KEEP_LOTTERY_LIST=755,e.PRIVILEGE_CARD_INFO=653,e.WEAR_SKIN=116,e.GUIDE_COMPLETE_STEP=22,e.ACTIVITY_INVITE=114,e.DAY_PURCHASE=756,e.RANK_LIST=800,e.RANK_GET_REWARD=801,e.ACTIVITY_STATE=757,e.LOTTERY_RANDOM_COUNT=758,e.GOLD_BODY_REWARD_LIST=115,e.SEVEN_REWARD_INFO=759,e.ACCUMULATE_HEROSOUL=119,e.REVIVE_BY_SKILL=120,e.ACTIVE_SKILL=121,e.FRIEND_RANK_LIST=802,e.FRIEND_HELP_LIST=850,e.FRIEND_HELP_SINGLE=851,e.FRIEND_HELP_MSG=852,e.NOTABLE=55,e.LOTTERY_COUNT=602,e.INVITE_AWARD=122,e.CHECK_MOODY=760,e.COLLECTION=761,e.LOGIN_ERROR=25,e.TASK_INFO=900,e}();__reflect(PackageInTypeVo.prototype,"PackageInTypeVo");var PackageOutTypeVo=function(){function e(){}return e.LOGIN=1,e.HEARTBEAT=2,e.PHONE_MODEL=3,e.ACHIEVEMENTS_PRO=250,e.ACHIEVEMENTS_GET_REWARD=251,e.ACHIEVEMENTS_GET_ALL_REWARD=252,e.HERO_LEVELUP=9,e.HEROSKILL_LEVELUP=10,e.HEROSKILL_LEVELUP_TOTAL=12,e.EQUIP_LOTTERY=350,e.EQUIP_LEVEL=351,e.EQUIP_DECOMPOSE=352,e.EQUIP_WEAR=353,e.DEL_ANCIENT=302,e.REFRESH_BUY=300,e.BUY_ANCIENT=301,e.ANCIENT_LEVELUP=304,e.SETUP=13,e.MERCENARY_UP_AND_DOWN=400,e.MERCENARY_TASK=401,e.MERCENARY_GET_TASK=402,e.MERCENARY_RESURRENCTION=403,e.MERCENARY_DEVOUR=404,e.MERCENARY_REPLACE=405,e.SHOP_BUY=450,e.SHOP_BUY_TIME=451,e.SHOP_LOTTERY_EQUIP=452,e.SHOP_LOTTERY_MERCENARY=453,e.SHOP_LOTTERY_SKIN=454,e.MERCENARY_REWARD=402,e.BATTLE_COMPLETE=100,e.ADD_MONEY_FROM_BATTLE=101,e.MAIL_READ=501,e.MAIL_DELETE=503,e.MAIL_ALL_GET=502,e.MAIL_GET_REWARD=500,e.USE_SKILL=11,e.RESOLVE_EQUIP=354,e.CHECK_TIME=455,e.CYCLE_HEROSOUL=456,e.MERCENARY_DATA_UPDATE=406,e.OFF_LINE_REWARD=102,e.GET_DAY_CHARGE_REWARD=701,e.ACCUMULATED_CHARGE_REWARD=702,e.SIMULATION_CHARGE=703,e.GET_FIRST_CHARGE_REWARD=704,e.DAY_SHARE_REWARD=751,e.SHARE_MSG=750,e.GET_CONSUME_GIFT_BAG=700,e.GET_REWARD_ONLINE=651,e.SIGN_MSG=652,e.CANCEL_RED_POINT=459,e.LOTTERY_STATE=458,e.LOTTERY_POS=460,e.USE_PROP_ITEM=900,e.KEEP_LOTTERY=461,e.PRIVILEGE_DAY_REWARD=705,e.WEAR_SKIN=457,e.GUIDE_COMPLETE_STEP=600,e.INVITE_GET_REWARD=850,e.CHECK_INVITE_FRIENDS=851,e.INVITE_FRIENDS=852,e.DAT_PURCHASE=462,e.GET_RANK_REWARD=800,e.RANDOM_GIFT=901,e.ACTIVITY_STATE=656,e.ACHIEVEMENT_REQUEST=253,e.OPEN_GOLD_BOX=103,e.SHOW_ANIMATION_OR_DRAW=14,e.LOOK_AD=655,e.CHECK_MASCOT_REWARD=658,e.SEVEN_DAY_REWARD=657,e.SKIP_LOTTERY_ANIM=463,e.BUY_SKILL_CD=15,e.EQUIP_LOCK=355,e.CHAT_MSG=50,e.FREE_REVIVE=16,e.FRIEND_RANK_LIST=801,e.SERVER_FRIEND_RANK_LIST=802,e.NPC_BEGIN_WORK=950,e.FRIEND_END_WORK=951,e.FREE_AUTOCLICK=602,e.INVITE_AWARD=853,e.GET_OFF_LINE_REWARD=104,e.NEWBIE=601,e.MOODY_REWARD=659,e.COLLECTION=660,e.CONCERN=661,e.COLLECTION_COMPLETE=662,e.TASK_FINISH=1e3,e.HERO_SKILL_BUY_ALL=17,e}();__reflect(PackageOutTypeVo.prototype,"PackageOutTypeVo");var SocketConfig=function(){function e(){}return e.IP="",e.HANDLER_MAX=50,e.KEY=[174,191,86,120,171,205,239,241],e.HOST="",e}();__reflect(SocketConfig.prototype,"SocketConfig");var GameSocketOut=function(){function e(e){var t=this;t._socketMgr=e}return e}();__reflect(GameSocketOut.prototype,"GameSocketOut");var PackageIn=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),Object.defineProperty(t.prototype,"checksum",{get:function(){return this._checksum},set:function(e){this._checksum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientId",{set:function(e){this._clientId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this._cmdID},set:function(e){this._cmdID=e},enumerable:!0,configurable:!0}),t.prototype.loadE=function(e,t,r){var n=this,o=0,a=new egret.ByteArray,i=new egret.ByteArray;for(e.position=0,o=0;t>o;o++)a.writeByte(e.readByte());a.position=0,r.position=0;var s,c,u,p,l,h=new egret.ByteArray,g=new egret.ByteArray;for(o=0;t>o;o++)o>0?(p=o%8,r.position=p,o>=8?(h.position>=8&&g.length>0&&(h.clear(),h=n.copyByteArray(g),g.clear()),h.position=p,u=h.readByte(),u=u+c^o,g.writeByte(u)):(u=r.readByte(),u=u+c^o,h.writeByte(u)),s=a.readByte(),l=s-c^u,i.writeByte(l),c=s):(s=a.readByte(),u=r.readByte(),l=s^u,i.writeByte(l),h.writeByte(u),c=s);var f=new egret.ByteArray;for(g.length>0&&(f=n.copyByteArray(g)),h.position=g.position,o=h.position;o<h.length;o++)f.writeByte(h.readByte());for(SocketManager.getInstance.socket.RECEIVE_KEY.clear(),SocketManager.getInstance.socket.RECEIVE_KEY=n.copyByteArray(f),f.clear(),h.clear(),g.clear(),i.position=0,n.position=0,o=0;t>o;o++)n.writeByte(i.readByte());n.readHeader()},t.prototype.load=function(e,t){var r=this;
e.position=0;for(var n=0;t>n;n++)r.writeByte(e.readByte());r.readHeader()},t.prototype.readHeader=function(){var e=this;e.position=0,e.readShort(),e._length=e.readShort(),e._checksum=e.readShort(),e._cmdID=e.readShort()},t.prototype.readBody=function(){var e=this,r=e,n=(r.length-t.HEADER_SIZE,new egret.ByteArray);r.position=t.HEADER_SIZE;for(var o=t.HEADER_SIZE;o<r.length;o++)n.writeByte(r.readByte());return n},t.prototype.calculateCheckSum=function(){var e=this,t=119,r=6;for(e.position=6;r<e.length;){r++;var n=e.readByte(),o=255&n;t+=o}var a=32639&t;return a},t.prototype.copyByteArray=function(e){e.position=0;for(var t=new egret.ByteArray,r=0;r<e.length;r++)t.writeByte(e.readByte());return t},t.HEADER_SIZE=8,t}(egret.ByteArray);__reflect(PackageIn.prototype,"PackageIn");var PackageOut=function(e){function t(r){var n=e.call(this,r)||this,o=n;return o.writeShort(t.HEADER),o.writeShort(0),o.writeShort(0),o.writeShort(0),o._checksum=0,n}return __extends(t,e),t.prototype.init=function(e){var t=this;t._cmdID=e,t.position=6,t.writeShort(t._cmdID)},t.prototype.pack=function(){var e=this;e._checksum=e.calculateCheckSum();var t=new egret.ByteArray;t.writeShort(e.length),t.writeShort(e._checksum),e.position=2,t.position=0,e.writeByte(t.readByte()),e.writeByte(t.readByte()),e.writeByte(t.readByte()),e.writeByte(t.readByte())},Object.defineProperty(t.prototype,"cmdID",{get:function(){return this._cmdID},enumerable:!0,configurable:!0}),t.prototype.calculateCheckSum=function(){var e=this,t=119,r=6;for(e.position=6;r<e.length;){r++;var n=e.readByte(),o=255&n;t+=o}return 32639&t},t.HEADER=29099,t}(egret.ByteArray);__reflect(PackageOut.prototype,"PackageOut");var SocketEventDispatcher=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t,"getInstance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}(egret.EventDispatcher);__reflect(SocketEventDispatcher.prototype,"SocketEventDispatcher");var SocketEvents=function(e){function t(t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),e.call(this,t,r,n)||this}return __extends(t,e),Object.defineProperty(t.prototype,"pkg",{get:function(){var e=this;return e._pkg},enumerable:!0,configurable:!0}),t.format=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=[],n=0;n<e.length;n++)r.push(e[n].toString(16));return r.join("+")},t.DATA="data",t.SOCKET_CONNECT="socketConnect",t.SOCKET_OPEN="socket_open",t.SOCKET_ERROR="socket_error",t.SOCKET_CLOSE="SOCKET_close",t.SOCKET_DATA="socket_data",t.SOCKET_CONNECT_STOP="socket_connect_stop",t.SOCKET_RECONNECT_SUCCESS="socket_reconnect_success",t}(egret.Event);__reflect(SocketEvents.prototype,"SocketEvents");var BigNumber=function(){function e(t,r,n){void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=-1),"number"==typeof t?0==t?(this.base=0,this.power=0):this.fromFloat(t):"string"==typeof t?this.fromString(t):t instanceof e?(this.base=t.base,this.power=t.power):(this.base=0,this.power=0)}return e.prototype.fromFloat=function(e){var t=this;t.base=e,t.power=0,t.normalize()},e.prototype.fromString=function(e){var t=e.split("e");this.base=Number(t[0]),t.splice(0,1),this.power=Number(t.join("e")),this.normalize()},e.prototype.normalize=function(){var e,t=this;if(0==t.base)return void(t.power=0);var r=Math.abs(t.base);r>=10?(e=Math.floor(Math.log(r)/Math.log(10)),t.base=t.base/Math.pow(10,e),t.power=t.power+e):1>r&&(e=0-Math.floor(Math.log(r)/Math.log(10)),t.base=t.base*Math.pow(10,e),t.power=t.power-e)},e.copy=function(t){var r=new e(0);return r.base=t.base,r.power=t.power,r},e.clone=function(t){return e.copy(t)},e.prototype.toString=function(){var e,t=this,r=t.base,n=t.power;if(5>n&&n>=0){for(;n>0;)r=10*r,n--;return e=r,t.normalize(),e.toString()}if(n>-5&&0>n){for(;0>n;)r/=10,n++;return e=r,t.normalize(),e.toString()}return r.toString()+"e"+n.toString()},e.prototype.toFixed=function(e){void 0===e&&(e=3);var t=this,r="",n=0,o=t.toString().split("e"),a=o[0].split(".");if(a[1])if(a[1].length<e)n=a[1].length,a[1]=a[1].substr(0,n);else{for(n=e;"0"==a[1].substr(n-1,1);)n--;a[1]=a[1].substr(0,n)}return o[1]?(o[0]=a[1]?a.join("."):a[0],r=o.join("e")):r=a[1]?a.join("."):a[0],r},e.prototype.toRoundShow=function(){var t,r=this,n=e.copy(r);n.normalize();var o=n.base,a=n.power;if(5>a&&a>=0){for(;a>0;)o=10*o,a--;return t=Math.round(o),t.toString()}if(a>-5&&0>a){for(;0>a;)o/=10,a++;return t=o,t.toFixed(3)}return e.charNumber?e.toCharNumber(n):n.toFixed()},e.prototype.numberValue=function(){var e=this;return e.base*Math.pow(10,e.power)},e.max=function(e,t){return e.biggerEqualThan(t)?e:t},e.min=function(e,t){return e.smallerEqualThan(t)?e:t},e.prototype.biggerEqualThan=function(e){var t=this,r=0;return 0==t.base?e.base<=0:0==e.base?t.base>=0:t.base<0!=e.base<0?t.base>e.base:(r=t.base>0?1:-1,r*t.power<r*e.power?!1:t.power==e.power?t.base>=e.base:!0)},e.prototype.biggerThan=function(e){var t=this,r=0;return 0==t.base?e.base<0:0==e.base?t.base>0:t.base<0!=e.base<0?t.base>e.base:(r=t.base>0?1:-1,r*t.power<r*e.power?!1:t.power==e.power?t.base>e.base:!0)},e.prototype.biggerThanOfNumber=function(t){var r=this;return 0==t?r.base>0:0==r.base?0>t:r.base<0!=0>t?r.base>t:r.biggerThan(new e(t))},e.prototype.biggerEqualThanOfNumber=function(t){var r=this;return 0==r.base?0>=t:0==t?r.base>=0:r.base<0!=0>t?r.base>t:r.biggerEqualThan(new e(t))},e.prototype.smallerEqualThan=function(e){var t,r=this;return 0==r.base?e.base>=0:0==e.base?r.base<=0:r.base<0!=e.base<0?r.base<e.base:(t=r.base>0?1:-1,t*r.power>t*e.power?!1:r.power==e.power?r.base<=e.base:!0)},e.prototype.smallerThan=function(e){var t,r=this;return 0==r.base?e.base>0:0==e.base?r.base<0:r.base<0!=e.base<0?r.base<e.base:(t=r.base>0?1:-1,t*r.power>t*e.power?!1:r.power==e.power?r.base<e.base:!0)},e.prototype.smallerThanOfNumber=function(t){var r=this;return r.smallerThan(new e(t))},e.prototype.smallerEqualThanOfNumber=function(t){var r=this;return r.smallerEqualThan(new e(t))},e.prototype.negate=function(){var t=this,r=e.copy(t);return r.base=-1*t.base,r},e.prototype.add=function(t){var r,n=this,o=e.copy(n),a=o.power-t.power;return a>10?o:-10>a?(o.base=t.base,o.power=t.power,o):0==a?(o.base=o.base+t.base,o.normalize(),o):a>0?(o.base=o.base*Math.pow(10,a),o.power=t.power,o.base=o.base+t.base,o.normalize(),o):0>a?(r=t.base*Math.pow(10,-a),o.base=o.base+r,o.normalize(),o):o},e.prototype.addN=function(t){var r=this;return r.add(new e(t))},e.prototype.plusEquals=function(e){var t,r=this,n=r.power-e.power;return n>10?void 0:-10>n?(r.base=e.base,void(r.power=e.power)):0==n?(r.base=r.base+e.base,void r.normalize()):n>0?(r.base=r.base*Math.pow(10,n),r.power=e.power,r.base=r.base+e.base,void r.normalize()):0>n?(t=e.base*Math.pow(10,-n),r.base=r.base+t,void r.normalize()):void 0},e.prototype.minusEquals=function(e){var t,r=this,n=r.power-e.power;return n>10?void 0:-10>n?(r.base=-e.base,void(r.power=e.power)):0==n?(r.base=r.base-e.base,void r.normalize()):n>0?(r.base=r.base*Math.pow(10,n),r.power=e.power,r.base=r.base-e.base,void r.normalize()):0>n?(t=e.base*Math.pow(10,-n),r.base=r.base-t,void r.normalize()):void 0},e.prototype.subtract=function(t){var r=this,n=e.copy(t);return n.base=-n.base,r.add(n)},e.prototype.multiply=function(t){var r=this,n=e.copy(r);return n.base=n.base*t.base,n.power=n.power+t.power,n.normalize(),n},e.prototype.timesEquals=function(e){var t=this;t.base=t.base*e.base,t.power=t.power+e.power,t.normalize()},e.prototype.multiplyN=function(t){var r=this,n=e.copy(r);return n.base=n.base*t,n.normalize(),n},e.prototype.timesEqualsN=function(e){var t=this;t.base=t.base*e,t.normalize()},e.prototype.divide=function(t){var r=this,n=e.copy(r),o=n.base/t.base;return 1e4>o&&(o=1e4*o,n.power=n.power-4),n.base=o,n.power=n.power-t.power,n.normalize(),n},e.prototype.divideN=function(t){var r=this;return r.divide(new e(t))},e.prototype.sqrt=function(){var t=this,r=e.copy(t);return r.power%2!=0&&(r.power=r.power-1,r.base=10*r.base),r.base=Math.sqrt(r.base),r.power=r.power/2,r.normalize(),r},e.prototype.pow=function(t){var r=this,n=e.copy(r),o=new e(1);if(0==t)return o;for(0>t&&(n=o.divide(n),t=-t);t>1;)t%2==0?(n.base=n.base*n.base,n.power=n.power+n.power,n.normalize(),t/=2):(o.base=n.base*o.base,o.power=n.power+o.power,o.normalize(),n.base=n.base*n.base,n.power=n.power+n.power,n.normalize(),t=(t-1)/2);return n.base=n.base*o.base,n.power=n.power+o.power,n.normalize(),n},e.prototype.percentIncreaseToMultiplier=function(){var e=this;return e.multiplyN(.01).addN(1)},e.prototype.equal=function(e){var t=this;return t.power!=e.power?!1:t.base==e.base?!0:!1},e.prototype.equalOfNumber=function(t){var r=this;return r.equal(new e(t))},e.prototype.floor=function(){var t,r=this,n=e.copy(r);return n.power<15&&(t=n.power,n.base=n.base*Math.pow(10,t),n.power=n.power-t,n.base=Math.floor(n.base),n.normalize()),n},e.prototype.ceil=function(){var t,r=this,n=e.copy(r);return n.power<15&&(t=n.power,n.base=n.base*Math.pow(10,t),n.power=n.power-t,n.base=Math.ceil(n.base),n.normalize()),n},e.prototype.round=function(){var t=this,r=e.copy(t),n=r.floor();return r.subtract(n).biggerThanOfNumber(.5)?r.ceil():n},e.toCharNumber=function(t){var r="",n="",o=0;if("number"==typeof t){var a=Number(t),i=Math.round(a).toString();if(i.length>5+3*e.totalChar)r=new e(a).toFixed();else if(i.length<=5)r=i;else{o=Math.ceil((i.length-5)/3),n=e.transformChar(o);var s=i.substr(0,i.length-3*o);r=e.headAdd(s)+n}}else{var c=e.copy(t);if(c.normalize(),c.power>4+3*e.totalChar)r=c.toFixed();else{for(var u=c.power;u>4;)u-=3,o++;if(0==o)r=String(Math.floor(c.base*Math.pow(10,u)));else{n=e.transformChar(o);var p=String(Math.floor(c.base*Math.pow(10,u)));r=e.headAdd(p)+n}}}return r},e.transformChar=function(t){var r="",n="",o="";if(t<=e.charFour.length)o=e.charFour[t-1];else{var a=t-e.charFour.length-1,i=0;i=a<e.lettersCount?97:65,r=String.fromCharCode(a%e.lettersCount+i),n=a<2*e.lettersCount&&a>=e.lettersCount?r.toLowerCase():r,o=r+n}return o},e.headAdd=function(e){var t,r=e,n=r.length;return n>3&&(t=r.split(""),t.splice(n-3,0,","),r=t.join("")),r},e.charNumber=!1,e.charFour=["K","M","B","T"],e.lettersCount=26,e.totalChar=82,e}();__reflect(BigNumber.prototype,"BigNumber");var SkinName=function(){function e(){}return e.LoginViewSkin="resource/gameSkins/login/LoginViewSkin.exml",e.GameMainViewSkin="resource/gameSkins/game/GameMainViewSkin.exml",e.BlockItemSkin="resource/gameSkins/game/BlockItemSkin.exml",e.TetrisItemSkin="resource/gameSkins/game/TetrisItemSkin.exml",e.MapItemSkin="resource/gameSkins/game/MapItemSkin.exml",e}();__reflect(SkinName.prototype,"SkinName");var ViewClassName=function(){function e(){}return e.LoginView=LoginView,e.GameMainView=GameMainView,e}();__reflect(ViewClassName.prototype,"ViewClassName");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var LayerManager=function(){function e(){this._layers=[],this._sceneContainer=new eui.UILayer,this._gameContainer=new eui.UILayer}return Object.defineProperty(e.prototype,"sceneContainer",{get:function(){var e=this;return e._sceneContainer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameContainer",{get:function(){var e=this;return e._gameContainer},enumerable:!0,configurable:!0}),Object.defineProperty(e,"getInstance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.setup=function(t){var r=this;this.createAllLayers(),r._sceneContainer.touchThrough=!0,r._gameContainer.touchThrough=!0,t.addChild(r._sceneContainer),t.addChild(r.getLayerByType(e.POP_LAYER)),t.addChild(r.getLayerByType(e.TIP_LAYER)),r._sceneContainer.addChild(r._gameContainer),r._sceneContainer.addChild(r.getLayerByType(e.SCENE_BASE_LAYER)),r._sceneContainer.addChild(r.getLayerByType(e.SCENE_UI_LAYER)),r._sceneContainer.addChild(r.getLayerByType(e.SCENE_UI_EFFECT_LAYER)),r._sceneContainer.addChild(r.getLayerByType(e.SCENE_POP_LAYER)),r._gameContainer.addChild(r.getLayerByType(e.GAME_MAP_LAYER)),r._gameContainer.addChild(r.getLayerByType(e.GAME_EFFECT_LAYER)),r._gameContainer.addChild(r.getLayerByType(e.GAME_MASCOT_LAYER)),r._gameContainer.addChild(r.getLayerByType(e.GAME_UI_LAYER)),r._gameContainer.addChild(r.getLayerByType(e.GAME_POP_LAYER)),r._gameContainer.addChild(r.getLayerByType(e.SCENE_RANK_LAYER)),t.addEventListener(egret.Event.RESIZE,r.onStageResize,r)},e.prototype.onStageResize=function(e){this.resize()},e.prototype.createAllLayers=function(){for(var t=0;t<e.layerCount;t++)this._layers.push(this.createOnLayer(t))},e.prototype.createOnLayer=function(e){var t=new DisplayLayer;return t.layerType=e,t.touchThrough=!0,t},e.prototype.addToLayer=function(e,t,r){void 0===r&&(r=!1);var n=this.getLayerByType(t);n.addChild(e),r&&DisplayUtils.centerObjectToStage(e,!0)},e.prototype.getLayerByType=function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t].layerType==e)return this._layers[t]},e.prototype.resize=function(){LogManager.logFormat("【 LayerManager 】stageResized----");for(var e=StageUtils.getInstance.stage.stageWidth,t=StageUtils.getInstance.stage.stageHeight,r=0;r<this._layers.length;r++)for(var n=this._layers[r],o=0;o<n.numChildren;o++){var a=n.getChildAt(o);instanceOfIStageResizeable(a)&&a.resize(e,t)}},e.TIP_LAYER=0,e.POP_LAYER=1,e.SCENE_RANK_LAYER=11,e.SCENE_POP_LAYER=2,e.SCENE_UI_EFFECT_LAYER=3,e.SCENE_UI_LAYER=4,e.SCENE_BASE_LAYER=5,e.GAME_POP_LAYER=6,e.GAME_UI_LAYER=7,e.GAME_EFFECT_LAYER=8,e.GAME_MASCOT_LAYER=10,e.GAME_MAP_LAYER=9,e.layerCount=12,e}();__reflect(LayerManager.prototype,"LayerManager");var ScenesManager=function(){function e(){var e=this;e._views=new TSDictionary}return Object.defineProperty(e.prototype,"currView",{get:function(){var e=this;return e._currView},set:function(e){var t=this;t._currView=e},enumerable:!0,configurable:!0}),e.prototype.openView=function(e,t,r,n,o,a){void 0===t&&(t=LayerManager.GAME_MAP_LAYER),void 0===n&&(n=!0),void 0===o&&(o=!1),void 0===a&&(a=!1);var i=this;return null!=i._currView&&e.uiName==i._currView.uiName?LogManager.logFormat("不可以切换同一个界面!"+e.uiName):(e.type==UIType.Scene?(i.hideCurrView(),i._sceneView=e):e.type==UIType.Panel&&n&&(t=LayerManager.GAME_UI_LAYER),i.showView(e,t,r,o),i._currView.fullScreen=a,void(i._currView.fullScreen&&i.hideScene()))},e.prototype.showView=function(e,t,r,n){void 0===n&&(n=!1);var o=this;if(o._views.ContainsKey(e.uiName)&&!n){var a=o._views.TryGetValue(e.uiName);o._currView=a,a.visible=!0,a.init(r,null),LayerManager.getInstance.addToLayer(a,t)}else o._currView=e,null!=o._currView&&(o._views.Add(o._currView.uiName,o._currView),o._currView.init(r,null),LayerManager.getInstance.addToLayer(o._currView,t))},e.prototype.hideScene=function(){var e=this;null!=e._sceneView&&(e._sceneView.visible=!1)},e.prototype.ShowScene=function(){var e=this;null!=e._sceneView&&(e._sceneView.visible=!0)},e.prototype.hideCurrView=function(){var e=this;null!=e._sceneView&&(e._sceneView.visible=!1,e._sceneView.hide(),e._sceneView.isCache||(e._views.Remove(e._sceneView.uiName),e._sceneView.dispose(),e._sceneView=null)),e._sceneView=null},e.prototype.hideView=function(e){var t=this,r=e+"";if(t._views.ContainsKey(r)){var n=t._views.TryGetValue(r);n.visible=!1,t._currView=null}},e.prototype.removeView=function(e){var t=this,r=e+"";if(t._views.ContainsKey(r)){var n=t._views.TryGetValue(r);n.close(),t._views.Remove(r)}},Object.defineProperty(e.prototype,"views",{get:function(){var e=this;return e._views},set:function(e){var t=this;t._views=e},enumerable:!0,configurable:!0}),e.prototype.removeAllView=function(){for(var e=this,t=e._views.getValues(),r=0;r<t.length;r++)t[r].dispose(),DisplayUtils.removeAllChildren(e._views.getValues()),t[r]=null;e._views.clear()},Object.defineProperty(e,"getInstance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}();__reflect(ScenesManager.prototype,"ScenesManager");var TouchPoint=function(){function e(){this.positions=[]}return e}();__reflect(TouchPoint.prototype,"TouchPoint");var UIModel=function(){function e(){}return e}();__reflect(UIModel.prototype,"UIModel");var UIType;!function(e){e[e.Scene=0]="Scene",e[e.Panel=1]="Panel",e[e.Alert=2]="Alert"}(UIType||(UIType={}));var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this,r=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",r),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),t.initData(),ext.loadServerConfig(function(){t.initPlatform()})},t.prototype.initData=function(){var e=this;egret.ImageLoader.crossOrigin="anonymous",StageUtils.getInstance.setup(e.stage),LayerManager.getInstance.setup(e.stage),StageUtils.setFrameRate(30),GameConfig.IsMobile=egret.Capabilities.isMobile,egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME?(this.stage.orientation=egret.OrientationMode.PORTRAIT,StageUtils.setScaleMode(egret.StageScaleMode.EXACT_FIT)):"windows"==GameConfig.systemType()?(this.stage.orientation=egret.OrientationMode.AUTO,StageUtils.setScaleMode(egret.StageScaleMode.SHOW_ALL)):(this.stage.orientation=egret.OrientationMode.PORTRAIT,StageUtils.setScaleMode(egret.StageScaleMode.SHOW_ALL))},t.prototype.initPlatform=function(){var e=this;PathManager.Instance.resourceUrl=ext.getResourceUrl(),e.loadConfigs()},t.prototype.loadConfigs=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(r){for(e=PathManager.Instance.ConfigUrls,t=0;t<e.length;t++)ResUtil.getInstance.addConfig(e[t],PathManager.Instance.resourceUrl);return ResUtil.getInstance.loadConfig(this.loadLoadingResource,this),[2]})})},t.prototype.loadLoadingResource=function(){var e=this;ResUtil.getInstance.loadGroup(["game"],function(){e.loadTheme()},e)},t.prototype.loadTheme=function(){var e=this,t=new eui.Theme(PathManager.Instance.ThemePath,this.stage),r=function(){var t=function(e,t){LanguageManager.getInstance.setup(e)};e.createGameScene(),RES.getResByUrl(PathManager.Instance.language_path,t,e,RES.ResourceItem.TYPE_TEXT)};t.addEventListener(eui.UIEvent.COMPLETE,r,this)},t.prototype.createGameScene=function(){egret.Capabilities.runtimeType!=egret.RuntimeType.WXGAME&&(document.getElementById("preloading").style.display="none",document.getElementById("circleId").style.display="none"),LoginManager.getInstance.setup(),ScenesManager.getInstance.openView(UIUtil.createScene(ViewClassName.LoginView),LayerManager.GAME_MAP_LAYER,!0),"dev"==ext.getPlatform()},t}(eui.UILayer);__reflect(Main.prototype,"Main");var SimpleList=function(e){function t(){var t=e.call(this)||this;return t._items=[],t.touchPoints=[],t.DistanceToTime=700,t.PositionMutiply=4,t._mask=new egret.Shape,t._viewWidth=0,t._viewHeight=0,t._minItemHeight=0,t._itemGap=0,t._scrollPosition=0,t}return __extends(t,e),t.prototype.initList=function(){null!=this._itemRender&&0!=this._minItemHeight&&0!=this._viewWidth&&0!=this._viewHeight&&(this.createMask(),this.createListItems(),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this))},t.prototype.onTouchBegin=function(e){var t=this.searchTouchPoint(e.touchPointID);null==t&&(t=new TouchPoint,t.touchPointID=e.touchPointID),t.positions.push(new egret.Point(e.stageX,e.stageY)),this.touchPoints.push(t)},t.prototype.onTouchMove=function(e){this.updateScroll(e.touchPointID,e.stageX,e.stageY,!1)},t.prototype.onTouchEnd=function(e){var t=this.updateScroll(e.touchPointID,e.stageX,e.stageY,!0);ObjectUtils.removeFromArray(t,this.touchPoints)},t.prototype.searchTouchPoint=function(e){for(var t=0;t<this.touchPoints.length;t++)if(this.touchPoints[t].touchPointID==e)return this.touchPoints[t]},t.prototype.updateScroll=function(e,t,r,n){var o=this.searchTouchPoint(e);if(null==o)return null;o.positions.push(new egret.Point(t,r));var a=o.positions.length-1,i=egret.Point.distance(o.positions[a],o.positions[a-1]);n&&(i*=this.PositionMutiply),o.positions[a].y<o.positions[a-1].y&&(i=-i);var s=MathUtils.Clamp(0,this.getMaxScrollPosition(),this.scrollPosition+i);return n?egret.Tween.get(this).to({scrollPosition:s},Math.abs(i)/this.DistanceToTime*1e3,egret.Ease.backOut):this.scrollPosition=s,o},t.prototype.createMask=function(){this._mask.graphics.beginFill(16711680),this._mask.graphics.drawRect(0,0,this._viewWidth,this._viewHeight),this._mask.graphics.endFill(),this.addChild(this._mask),this.mask=this._mask},t.prototype.createListItems=function(){for(var e=this._viewHeight/this._minItemHeight+2,t=0;e>t;t++){var r=new this._itemRender;this._items.push(r)}},t.prototype.render=function(){if(null!=this._data)for(var e=this.positionToStartIndex(this._scrollPosition),t=e[0],r=e[1],n=0;n<this._items.length;n++){var o=this._items[n],a=this._data[n+t];null!=a?(this.addChild(o),o.dataUpdate(a),this._data[n+t].$itemHeight=o.height,o.y=r,r+=o.height,r+=this.itemGap):DisplayUtils.removeFromParent(o)}},t.prototype.positionToStartIndex=function(e){var t,r=e,n=r;for(t=0;t<this.data.length;t++){if(r>=0)return[t-1,n];n=r,r+=this.data[t].$itemHeight?this.data[t].$itemHeight:this.minItemHeight,r+=this.itemGap}return[t-1,n]},t.prototype.getMaxScrollPosition=function(){for(var e=0,t=0;t<this.data.length;t++)e-=this.data[t].$itemHeight?this.data[t].$itemHeight:this.minItemHeight,e-=this.itemGap;return e+this._viewHeight},Object.defineProperty(t.prototype,"itemRender",{set:function(e){this._itemRender=e,this.initList()},enumerable:!0,configurable:!0}),t.prototype.viewport=function(e,t){this._viewWidth=e,this._viewHeight=t,this.initList()},Object.defineProperty(t.prototype,"minItemHeight",{get:function(){return this._minItemHeight},set:function(e){this._minItemHeight=e,this.initList()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemGap",{get:function(){return this._itemGap},set:function(e){this._itemGap=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.render()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollPosition",{get:function(){return this._scrollPosition},set:function(e){this._scrollPosition=e,this.render()},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);__reflect(SimpleList.prototype,"SimpleList");var UI;!function(e){var t=function(){function e(e,t){this._view=null,this._btnArr=[];var r=this;r._view=e,r._btnArr=t,r.initBtnEffect()}return e.prototype.initBtnEffect=function(){var e=this;if(e._btnArr&&e._btnArr.length)for(var t=e._btnArr.length,r=0;t>r;r++)e._view[e._btnArr[r]].addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onBtnBegin,e),e._view[e._btnArr[r]].anchorOffsetY=e._view[e._btnArr[r]].height/2,e._view[e._btnArr[r]].anchorOffsetX=e._view[e._btnArr[r]].width/2,e._view[e._btnArr[r]].x=e._view[e._btnArr[r]].x+e._view[e._btnArr[r]].width/2,e._view[e._btnArr[r]].y=e._view[e._btnArr[r]].y+e._view[e._btnArr[r]].height/2},e.prototype.onBtnBegin=function(e){var t=this,r=e.target;r&&(t._curBtn=r);var n=r.name;if(n)var o=Number(n.split("_")[1]),a=Number("0x"+n.split("_")[3]);var i=n.split("#")[1];if(i)if("1"==i?SoundManager.playEffect(10005):"2"==i?SoundManager.playEffect(10006):"3"===i?SoundManager.playEffect(10007):"4"===i&&SoundManager.playEffect(10008),o||(o=1),t._curType=o,r.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onTouchCancle,t),r.$stage.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),e.updateAfterEvent(),1==o)r.scaleY=r.scaleY-.1,r.scaleX=r.scaleX-.1;else if(2==o){if(r.numChildren){var s=r.getChildAt(0);s&&(s.visible=!0);var c=r.getChildAt(1);c&&(c.visible=!1);var u=r.getChildAt(2);a&&u&&(u.textColor=a)}}else if(3==o){if(r.scaleY=r.scaleY-.1,r.scaleX=r.scaleX-.1,r.numChildren){var s=r.getChildAt(0);s&&(s.visible=!0);var c=r.getChildAt(1);c&&(c.visible=!1);var u=r.getChildAt(2);a&&u&&(u.textColor=a)}}else if(4==o){var s=r.getChildAt(0);s&&(s.visible=!0);var c=r.getChildAt(1);c&&(c.visible=!1)}},e.prototype.onTouchCancle=function(e){var t=this,r=t._curBtn;if(r){var n=e.$currentTarget,o=Number("0x"+r.name.split("_")[2]);if(n.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onTouchCancle,t),n.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),1==t._curType)r.scaleY=r.scaleY+.1,r.scaleX=r.scaleX+.1;else if(2==t._curType){if(r.numChildren){var a=r.getChildAt(0);a&&(a.visible=!1);var i=r.getChildAt(1);i&&(i.visible=!0);var s=r.getChildAt(2);o&&s&&(s.textColor=o)}}else if(3==t._curType){if(r.scaleY=r.scaleY+.1,r.scaleX=r.scaleX+.1,r.numChildren){var a=r.getChildAt(0);a&&(a.visible=!1);var i=r.getChildAt(1);i&&(i.visible=!0);var s=r.getChildAt(2);o&&s&&(s.textColor=o)}}else if(4==t._curType){var a=r.getChildAt(0);a&&(a.visible=!1);var i=r.getChildAt(1);i&&(i.visible=!0)}}},e.prototype.onTouchEnd=function(e){var t=this,r=t._curBtn;if(r){var n=e.$currentTarget,o=Number("0x"+r.name.split("_")[2]);if(n.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onTouchCancle,t),n.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),1==t._curType)r.scaleY=r.scaleY+.1,r.scaleX=r.scaleX+.1;else if(2==t._curType){if(r.numChildren){var a=r.getChildAt(0);a&&(a.visible=!1);var i=r.getChildAt(1);i&&(i.visible=!0);var s=r.getChildAt(2);o&&s&&(s.textColor=o)}}else if(3==t._curType){if(r.scaleY=r.scaleY+.1,r.scaleX=r.scaleX+.1,r.numChildren){var a=r.getChildAt(0);a&&(a.visible=!1);var i=r.getChildAt(1);i&&(i.visible=!0);var s=r.getChildAt(2);o&&s&&(s.textColor=o)}}else if(4==t._curType){var a=r.getChildAt(0);a&&(a.visible=!1);var i=r.getChildAt(1);i&&(i.visible=!0)}}},e.prototype.dispose=function(){var e=this;if(e._btnArr&&e._btnArr.length)for(var t=e._btnArr.length,r=0;t>r;r++)e._view[e._btnArr[r]].removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onBtnBegin,e),e._view[e._btnArr[r]].anchorOffsetY=e._view[e._btnArr[r]].height/2,e._view[e._btnArr[r]].anchorOffsetX=e._view[e._btnArr[r]].width/2,e._view[e._btnArr[r]].x=e._view[e._btnArr[r]].x+e._view[e._btnArr[r]].width/2,e._view[e._btnArr[r]].y=e._view[e._btnArr[r]].y+e._view[e._btnArr[r]].height/2;e._btnArr=[],e._curBtn=null},e}();e.BtnEffectComponent=t,__reflect(t.prototype,"UI.BtnEffectComponent")}(UI||(UI={}));var UI;!function(e){var t=function(e){function t(t){var r=e.call(this)||this;r._select=!1;var n=r;return n.skinName=t,n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onRemoveFromStage,n,!1),n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n,!1),r}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);var t=this;LanguageManager.getInstance.setModuleLanguage(t)},t.prototype.update=function(e){void 0===e&&(e=null);for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&(this._info=e),this.updateView()},t.prototype.updateView=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.hasData=function(e){for(var t=this,r=t.getDatas(),n=0;n<r.length;n++)if(r[n]==e)return!0;return!1},t.prototype.getDatas=function(){return null},t.prototype.onDataChanged=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},t.prototype.onAddToStage=function(e){var t=this;t.showToStage(),t.addEvents()},t.prototype.showToStage=function(){},t.prototype.onRemoveFromStage=function(e){var t=this;t.removeEvents()},t.prototype.selectView=function(){},Object.defineProperty(t.prototype,"select",{get:function(){return this._select},set:function(e){var t=this;t._select=e,t.selectView()},enumerable:!0,configurable:!0}),t.prototype.addEvents=function(){},t.prototype.removeEvents=function(){},t.prototype.hide=function(){var e=this;null!=e.parent&&e.parent.removeChild(e)},t.prototype.gotoCallBack=function(){},t.prototype.dispose=function(){var e=this;e.hide()},t}(eui.ItemRenderer);e.BaseItem=t,__reflect(t.prototype,"UI.BaseItem")}(UI||(UI={}));var UI;!function(e){var t=function(e){function t(t){var r=e.call(this,t)||this;r.offsetX=0,r.offsetY=0,r.offsetW=0,r.offsetH=0,r.isDispose=!1,r.isMaskTouch=!0;var n=r;return n.type=UIType.Alert,n.isCache=!1,r}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this);var t=this;t.isDispose=!1,t.onDisplayResizeHandler(),t.maskImg||t.getImgMask(.7),t.anchorOffsetY=StageUtils.getInstance.stage.stageHeight,LayerManager.getInstance.addToLayer(t.maskImg,LayerManager.GAME_UI_LAYER),this.x=StageUtils.getInstance.stage.stageWidth-this.width>>1,this.y=StageUtils.getInstance.stage.stageHeight-this.height>>1,LayerManager.getInstance.addToLayer(t,LayerManager.GAME_POP_LAYER),egret.Tween.get(t).to({anchorOffsetY:0},300).call(function(){egret.Tween.removeTweens(t)}),t.isMaskTouch&&t.maskImg&&t.maskImg.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onMaskHandler,t),t.btn_close&&t.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,t.closePanel,t)},t.prototype.showToStage=function(){e.prototype.showToStage.call(this)},t.prototype.addEvents=function(){e.prototype.addEvents.call(this);var t=this;t.addEventListener(egret.Event.RESIZE,t.onDisplayResizeHandler,t)},t.prototype.removeEvents=function(){e.prototype.removeEvents.call(this);var t=this;t.btn_close&&t.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,t.closePanel,t),t.isMaskTouch&&t.maskImg&&t.maskImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,t.onMaskHandler,t),t.removeEventListener(egret.Event.RESIZE,t.onDisplayResizeHandler,t)},t.prototype.onMaskHandler=function(){var e=this;e.closePanel()},t.prototype.onDisplayResizeHandler=function(){var e=this;e.x=(StageUtils.getInstance.stage.stageWidth-(e.width-e.offsetW)>>1)+e.offsetX,e.y=(StageUtils.getInstance.stage.stageHeight-(e.height-e.offsetH)>>1)+e.offsetY},t.prototype.getMask=function(e){var t=new eui.Rect;return t.touchEnabled=!0,t.percentWidth=100,t.percentHeight=100,t.fillColor=0,t.fillAlpha=e,t},t.prototype.getImgMask=function(e){var t=this;t.maskImg=new eui.Image,t.maskImg.source="com_json.frame_alpha_1",t.maskImg.alpha=e,t.maskImg.scale9Grid=new egret.Rectangle(12,12,76,76),t.maskImg.bottom=0,t.maskImg.top=0,t.maskImg.right=0,t.maskImg.left=0},t.prototype.closePanel=function(){var e=this;return null!=e.getBackName()?void ScenesManager.getInstance.openView(UIUtil.createAlert(e.getBackName())):void e.dispose()},t.prototype.hide=function(){e.prototype.hide.call(this);var t=this;DisplayUtils.removeFromParent(t.maskImg),t.maskImg=null},t}(e.BaseView);e.BaseAlert=t,__reflect(t.prototype,"UI.BaseAlert")}(UI||(UI={}));var UI;!function(e){var t=function(e){function t(t){var r=e.call(this,t)||this,n=r;return n.type=UIType.Panel,r}return __extends(t,e),t}(e.BaseView);e.BasePanel=t,__reflect(t.prototype,"UI.BasePanel")}(UI||(UI={}));var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var CSVParser=function(){function e(){}return e.ParseJsonData=function(e,t){var r=this,n=new TSDictionary;t=t.trim();var o=JSON.parse(t),a=null,i=null,s=null,c=null;if(a=o.titles,null==o.data)return n;s=o.data,i=s[0];var u=0,p=s.length;for(u=0;p>u;u++){var l=new e;c=s[u],r.ParseRecord(a,c,l),n.Add(parseInt(c[0]),l)
}return t=null,n},e.ParseRecord=function(e,t,r){for(var n=t.length,o=0;n>o;o++)r[e[o]]=t[o]},e}();__reflect(CSVParser.prototype,"CSVParser");var DisplayUtils=function(){function e(){}return e.getChildIndex=function(e){return null==e||null==e.parent?-1:e.parent.getChildIndex(e)},e.textDotAnimation=function(e){var t=e.text,r=egret.Tween.get(e,{loop:!0});r.to({},500).call(function(){e.text=t+"."}),r.to({},500).call(function(){e.text=t+".."}),r.to({},500).call(function(){e.text=t+"..."}),r.to({},500).call(function(){e.text=t}),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){egret.Tween.removeTweens(e),r=null},this)},e.getLocalPos=function(e,t,r){var n=t.localToGlobal(r.x,r.y);return e.globalToLocal(n.x,n.y)},e.safeRemoveChild=function(e){null!=e&&null!=e.parent&&e.parent.removeChild(e)},e.scaleToNormalSizeWithContainer=function(t,r){var n=e.searchContainerScale(t.parent,r);t.scaleX=1/n,t.scaleY=1/n},e.searchContainerScale=function(t,r){var n=1;return t!=r&&(n=e.searchContainerScale(t.parent,r)*n),n},e.createBitmap=function(e){var t=new egret.Bitmap,r=RES.getRes(e);return t.texture=r,t.name=e,t},e.setBoxLayout=function(e,t,r,n){var o=r.y-(e.y+e.height);o>0&&t.scaleY},e.removeFromParent=function(e){e&&(e.parent&&e.parent.removeChild(e),e=null)},e.removeAllChildren=function(e){if(e&&e&&e.numChildren)for(;e.numChildren;){var t=e.getChildAt(0);t&&(t.parent&&t.parent.removeChild(t),t=null)}},e.disposeAllChildren=function(e){if(e&&e&&e.numChildren)for(;e.numChildren;){var t=e.getChildAt(0);t&&(t.parent&&t.dispose(),t=null)}},e.traceAllChildren=function(e){if(e)for(var t=0;t<e.numChildren;t++){e.getChildAt(t)}},e.setText=function(e,t){if(void 0===t&&(t=""),e){var r=new egret.HtmlTextParser;e.textFlow=r.parser(t)}},e.traceDisplayObjectWhyNotDisplay=function(e){null!=e.parent&&this.traceDisplayObjectWhyNotDisplay(e.parent)},e.resetDisplay=function(e){null!=e&&(e.x=0,e.y=0,e.scaleX=1,e.scaleX=1)},e.addToStageCenter=function(t,r){void 0===r&&(r=!1),StageUtils.getInstance.stage.addChild(t),e.centerObjectToStage(t,r)},e.centerObjectToStage=function(e,t){void 0===t&&(t=!1),t?(e.x=StageUtils.getInstance.stage.stageWidth/2,e.y=StageUtils.getInstance.stage.stageHeight/2):(e.x=(StageUtils.getInstance.stage.stageWidth-e.width)/2,e.y=(StageUtils.getInstance.stage.stageHeight-e.height)/2)},e.ifIsDisplay=function(e){return e.visible?0==e.alpha?!1:0==e.width?!1:0==e.height?!1:null==e.parent?!1:!0:!1},e.SortDisplayBy_Y=function(e,t){e.sort(function(e,t){return t.y-e.y});for(var r=0;r<e.length;r++)t.addChildAt(e[r],0)},e.layoutDisplayWithInnerRect=function(e,t,r,n){if(void 0===r&&(r=0),void 0===n&&(n=0),null!=t){0==r&&0==n?(r=e.parent.width,n=e.parent.height):-1==r&&-1==n&&(r=StageUtils.getInstance.stage.stageWidth,n=StageUtils.getInstance.stage.stageHeight);var o=t.getInnerRect(r,n);e.x=o.x,e.y=o.y,e.width=o.width,e.height=o.height}},e.addAsyncBimapToContainer=function(e,t){RES.getResByUrl(e,function(){var r=RES.getRes(e),n=new egret.Bitmap(r);t.addChild(n)},this,RES.ResourceItem.TYPE_IMAGE)},e.addAsyncBitmapToImage=function(e,t){RES.getResByUrl(e,function(){t.source=RES.getRes(e)},this,RES.ResourceItem.TYPE_IMAGE)},e.setFilters=function(e){if(e){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],r=new egret.ColorMatrixFilter(t);e.filters=[r]}},e.stableFramerate=30,e.red=16516357,e.white=16777215,e.black=0,e.green=6946645,e}();__reflect(DisplayUtils.prototype,"DisplayUtils");var InnerRectangle=function(){function e(e,t,r,n,o){void 0===o&&(o=0),this.para1=e,this.para2=t,this.para3=r,this.para4=n,this.lockDirection=o}return e.prototype.equals=function(e){return null==e?!1:this.para4==e.para4&&this.para1==e.para1&&this.lockDirection==e.lockDirection&&this.para2==e.para2&&this.para3==e.para3},e.prototype.getInnerRect=function(e,t){return this._outerWidth=e,this._outerHeight=t,this.calculateCurrent()},e.prototype.calculateCurrent=function(){var e=new egret.Rectangle;return this.lockDirection==LockDirectionTypes.UNLOCK?(e.x=this.para1,e.y=this.para3,e.width=this._outerWidth-this.para1-this.para2,e.height=this._outerHeight-this.para3-this.para4):this.lockDirection==LockDirectionTypes.LOCK_T?(e.x=this.para1,e.y=this.para3,e.width=this._outerWidth-this.para1-this.para2,e.height=this.para4):this.lockDirection==LockDirectionTypes.LOCK_L?(e.x=this.para1,e.y=this.para3,e.width=this.para2,e.height=this._outerHeight-this.para3-this.para4):this.lockDirection==LockDirectionTypes.LOCK_R?(e.x=this._outerWidth-this.para1-this.para2,e.y=this.para3,e.width=this.para1,e.height=this._outerHeight-this.para3-this.para4):this.lockDirection==LockDirectionTypes.LOCK_B?(e.x=this.para1,e.y=this._outerHeight-this.para3-this.para4,e.width=this._outerWidth-this.para1-this.para2,e.height=this.para3):this.lockDirection==LockDirectionTypes.NO_SCALE_T?(e.x=(this._outerWidth-this.para1)/2+this.para4,e.y=this.para3,e.width=this.para1,e.height=this.para2):this.lockDirection==LockDirectionTypes.NO_SCALE_B?(e.x=(this._outerWidth-this.para1)/2+this.para3,e.y=this._outerHeight-this.para4-this.para2,e.width=this.para1,e.height=this.para2):this.lockDirection==LockDirectionTypes.NO_SCALE_L?(e.x=this.para1,e.y=(this._outerHeight-this.para4)/2+this.para2,e.width=this.para3,e.height=this.para4):this.lockDirection==LockDirectionTypes.NO_SCALE_R?(e.x=this._outerWidth-this.para2-this.para3,e.y=(this._outerHeight-this.para3)/2+this.para1,e.width=this.para3,e.height=this.para4):this.lockDirection==LockDirectionTypes.NO_SCALE_TL?(e.x=this.para1,e.y=this.para3,e.width=this.para2,e.height=this.para4):this.lockDirection==LockDirectionTypes.NO_SCALE_TR?(e.x=this._outerWidth-this.para1-this.para2,e.y=this.para3,e.width=this.para1,e.height=this.para4):this.lockDirection==LockDirectionTypes.NO_SCALE_BL?(e.x=this.para1,e.y=this._outerHeight-this.para4-this.para3,e.width=this.para2,e.height=this.para3):this.lockDirection==LockDirectionTypes.NO_SCALE_BR?(e.x=this._outerWidth-this.para1-this.para2,e.y=this._outerHeight-this.para4-this.para3,e.width=this.para1,e.height=this.para3):this.lockDirection==LockDirectionTypes.UNLOCK_OUTSIDE?(e.x=-this.para1,e.y=-this.para3,e.width=this._outerWidth+this.para1+this.para2,e.height=this._outerHeight+this.para4+this.para3):this.lockDirection==LockDirectionTypes.NO_SCALE_C?(e.x=(this._outerWidth-this.para2)/2+this.para1,e.y=(this._outerHeight-this.para4)/2+this.para3,e.width=this.para2,e.height=this.para4):this.lockDirection==LockDirectionTypes.LOCK_TL?(e.x=this.para1,e.y=this.para2,e.width=this._outerWidth-this.para3,e.height=this._outerHeight-this.para4):this.lockDirection==LockDirectionTypes.LOCK_OUTER_DOWN&&(e.x=this.para1,e.y=this.para2,e.width=this._outerWidth-this.para3,e.height=this.para4),e},e}();__reflect(InnerRectangle.prototype,"InnerRectangle");var LockDirectionTypes=function(){function e(){}return e.LOCK_B=4,e.LOCK_L=2,e.LOCK_R=3,e.LOCK_T=1,e.UNLOCK=0,e.NO_SCALE_T=9,e.NO_SCALE_B=10,e.NO_SCALE_L=11,e.NO_SCALE_R=12,e.NO_SCALE_TL=13,e.NO_SCALE_TR=14,e.NO_SCALE_BL=15,e.NO_SCALE_BR=16,e.NO_SCALE_C=17,e.UNLOCK_OUTSIDE=-1,e.LOCK_TL=5,e.LOCK_TR=6,e.LOCK_OUTER_DOWN=18,e}();__reflect(LockDirectionTypes.prototype,"LockDirectionTypes");var MathUtils=function(){function e(){}return e.Clamp=function(e,t,r){return Math.max(t,Math.min(r,e))},e.Approximately=function(e,t){return Math.abs(e-t)<.01},e.Range=function(e,t){var r=Math.max(e,t),n=Math.min(e,t);return Math.random()*(r-n)+n},e.moveToNextPosition=function(t,r,n){var o=e.getAngle(t,r),a=t.x+n*Math.cos(o*Math.PI/180),i=t.y-n*Math.sin(o*Math.PI/180);t.x=a,t.y=i},e.getAngle=function(e,t){var r=t.x-e.x,n=t.y-e.y,o=Math.sqrt(Math.pow(r,2)+Math.pow(n,2)),a=Math.acos(r/o),i=180/(Math.PI/a);return 0>n?i=-i:0==n&&0>r&&(i=180),i},e.getNewAngle=function(e,t){var r=180+180*Math.atan2(e.x-t.x,e.y-t.y)/Math.PI;return r},e.randomBool=function(){return 1==Math.round(Math.random())},e.randomPointFromRect=function(e){var t=new egret.Point;return t.x=Math.random()*e[2]+e[0],t.y=Math.random()*e[3]+e[1],t},e.Deg2Rad=.01745329,e.Rad2Deg=57.29578,e.Max=9999999,e}();__reflect(MathUtils.prototype,"MathUtils");var ObjectPool=function(){function e(){this._objs=new Array}return e.prototype.pushObj=function(e){this._objs.push(e)},e.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},e.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},e.pop=function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];e._content[t]||(e._content[t]=[]);var a=e._content[t];if(a.length)return a.pop();var i,s=r,c=n.length;return 0==c?i=new s:1==c?i=new s(n[0]):2==c?i=new s(n[0],n[1]):3==c?i=new s(n[0],n[1],n[2]):4==c?i=new s(n[0],n[1],n[2],n[3]):5==c&&(i=new s(n[0],n[1],n[2],n[3],n[4])),i.ObjectPoolKey=t,i},e.popWithExtraKey=function(t,r){e._content[t]||(e._content[t]=[]);var n,o=e._content[t];if(o.length)for(var a=0;a<o.length;a++)if(o[a].extraKey==r){n=o[a],o.splice(a,1);break}if(!n){var i=egret.getDefinitionByName(t);n=new i(r),n.extraKey=r,n.ObjectPoolKey=t}return n},e.push=function(t){if(null==t)return!1;var r=t.ObjectPoolKey;return e._content[r]?(e._content[r].push(t),!0):!1},e.clear=function(){e._content={}},e.clearClass=function(t,r){void 0===r&&(r=null);for(var n=e._content[t];n&&n.length;){var o=n.pop();r&&o[r](),o=null}e._content[t]=null,delete e._content[t]},e.dealFunc=function(t,r){var n=e._content[t];if(null!=n){var o=0,a=n.length;for(o;a>o;o++)n[o][r]()}},e._content={},e}();__reflect(ObjectPool.prototype,"ObjectPool");var ObjectUtils=function(){function e(){}return e.copyValue=function(e,t){for(var r in t){var n=t[r],o=(egret.getQualifiedClassName(n),this.isBaseType(t[r]));o?e[r]=t[r]:this.copyValue(e[r],t[r])}},e.isBaseType=function(t){var r=egret.getQualifiedClassName(t),n=e.BASETYPES.indexOf(r);return-1!=n},e.removeFromArray=function(e,t){var r=t.indexOf(e);return r>=0&&t.splice(r,1),t},e.getRandomFromIn=function(e){if(null==e||e.length<1)return 0;var t=e[0]+Math.random()*(e[1]-e[0]),r=Math.floor(t);return r},e.getRandomStr=function(t,r){void 0===r&&(r="#");var n=t.split(r);return e.getRandomItem(n)},e.getRandomItem=function(e){if(null==e||e.length<1)return null;var t=Math.random()*e.length,r=Math.floor(t);return e[r]},e.shuffle=function(e){for(var t=e.length,r=t;r--;){var n=Math.floor(Math.random()*t);if(r!=n){var o=e[r];e[r]=e[n],e[n]=o}}},e.charExchange=function(e){for(var t=e,r=0;r<t.length;r++){t.substr(r,1)}return t},e.disposeArray=function(e){},e.splitToString=function(e,t){void 0===t&&(t=",");for(var r=[],n=e.split(t),o=0;o<n.length;o++)r.push(n[o]);return r},e.updateUrl=function(e,t){void 0===t&&(t="t");var r=new RegExp(t+"\\d+"),n=+new Date;if(e.indexOf(t)>-1)return e.replace(r,t+n);if(e.indexOf("?")>-1){var o=e.split("?");return o[1]?o[0]+"?"+t+n+"&"+o[1]:o[0]+"?"+t+n}return e.indexOf("#")>-1?e.split("#")[0]+"?"+t+n+location.hash:e+"?"+t+n},e.BASETYPES=["boolean","number","string","null"],e}();__reflect(ObjectUtils.prototype,"ObjectUtils");var ResourcePool=function(){function e(){this.main={},this.main[e.SKE]={},this.main[e.BITMAPTEXT]={},this.main[e.BITMAP]={}}return e.getIntance=function(){return this._ins||(this._ins=new e),this._ins},e.createOneByType=function(t,r){switch(r==e.Trace_ID&&LogManager.logFormat("ResourcePool . {0} : {1}","createOneByType",r),t){case e.SKE:var n=new BoneAnimation(r);BoneConfig.copyValueFromTemplate(n,r);return n.name=r,n.load(),n;case e.BITMAPTEXT:var o=new egret.BitmapText;return o.name=r,o.font=RES.getRes(r),o;case e.BITMAP:var a=new egret.Bitmap;return a.name=r,a.texture=RES.getRes(r),a}LogManager.errorFormat("Can't Create Instance of : "+t+"with ResId: "+r)},e.prototype.getPoolByType=function(t){switch(t){case e.SKE:return this.main[e.SKE];case e.BITMAPTEXT:return this.main[e.BITMAPTEXT];case e.BITMAP:return this.main[e.BITMAP]}return null},e.prepareItem=function(t,r){switch(r){case e.SKE:t instanceof BoneAnimation?t.initBone():LogManager.errorFormat("item type not match!!"+t.name+"  type :"+r)}},e.prototype.pop=function(t,r){var n=this.getPoolByType(r);null==n[t]&&(n[t]=[]),t==e.Trace_ID&&LogManager.logFormat("ResourcePool . {0} : {1}","pop",t);var o=n[t];if(o.length>0){var a=o.pop();return e.prepareItem(a,r),a}return e.createOneByType(r,t)},e.prototype.push=function(t,r){if(null!=t){var n=this.getPoolByType(r);if(null==n[t.name])return void console.log("回收对象的数组不存在",t.name);t.name==e.Trace_ID&&LogManager.logFormat("ResourcePool . {0} : {1}","push",t.name),n[t.name].push(t);var o=t.parent;null!=o&&o.removeChild(t),DisplayUtils.resetDisplay(t),t.resetForPool&&t.resetForPool()}},e.prototype.create=function(t,r,n){void 0===n&&(n=1);var o,a=[];for(t==e.Trace_ID&&LogManager.logFormat("ResourcePool . {0} : {1}  {2}","create",t,n),o=0;n>o;o++)a.push(this.pop(t,r));for(o=0;n>o;o++)this.push(a.pop(),r)},e.prototype.hasItem=function(e,t){if(null==e)return!1;var r=this.getPoolByType(t);if(null==r[e.name])return!1;var n=r[e.name];return n.indexOf(e)>=0},e.prototype.getLen=function(e,t){var r=this.getPoolByType(t);return r[e]?r[e].length:0},e.prototype.clear=function(t,r,n){function o(e){null!=e&&(n&&this.dealFun(e.name,r,n),e=null,delete a[e.name])}void 0===n&&(n="dispose");var a=this.getPoolByType(r);if(t==e.Trace_ID&&LogManager.logFormat("ResourcePool . {0} : {1}  {2}","clear",t,r),""==t)for(var i in a)o(a[i]);else o(a[t])},e.prototype.dealFun=function(e,t,r){var n=this.getPoolByType(t);if(n[e])for(var o=n[e],a=o.length,i=0;a>i;i++)o[i][r]&&o[i][r]()},e.prototype.printAll=function(){LogManager.logFormat("Start Print All Resource-------------");var e=0;for(var t in this.main){LogManager.logFormat("Start Print All Resource by type : "+t+"==================");for(var r in this.main[t]){var n=this.main[t][r].length;LogManager.logFormat("key :"+r+"  count:"+n),e+=n}}LogManager.logFormat("Start Print All Resource count : "+e+"==================")},e.SKE="Animation",e.BITMAPTEXT="BitmapText",e.BITMAP="Bitmap",e.Trace_ID="tx_01",e}();__reflect(ResourcePool.prototype,"ResourcePool");var ResUtil=function(){function e(){this._loadingGroups=[],this._configs=new Array,this._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceLoadProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)}return Object.defineProperty(e.prototype,"loadingGroups",{get:function(){return this._loadingGroups},enumerable:!0,configurable:!0}),e.prototype.addConfig=function(e,t){this._configs.push([e,t])},e.prototype.loadConfig=function(e,t){this._onConfigComplete=e,this._onConfigCompleteTarget=t,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var e=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(e[0],e[1])},e.prototype.onConfigCompleteHandle=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroupQuiet=function(e,t){void 0===t&&(t=1);var r=this.combGroupName(e);this._loadingGroups.indexOf(r)<0&&(this._loadingGroups.push(r),RES.loadGroup(r,t))},e.prototype.loadGroup=function(e,t,r,n){void 0===n&&(n=1);var o=this.combGroupName(e);this.createGroupInfo(o,t,null,r),this._loadingGroups.indexOf(o)<0&&(this._loadingGroups.push(o),RES.loadGroup(o,n))},e.prototype.loadGroupWithPro=function(e,t,r,n){var o=this.combGroupName(e);this.createGroupInfo(o,t,r,n),this._loadingGroups.indexOf(o)<0&&(this._loadingGroups.push(o),RES.loadGroup(o))},e.prototype.combGroupName=function(e){if("string"==typeof e)return e;for(var t=e.length,r="",n=0;t>n;n++)r+=e[n];return RES.createGroup(r,e,!1),r},e.prototype.createGroupInfo=function(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=null),this._groups[e]||(this._groups[e]=[]),this._groups[e].push({onComplete:t,thisObject:n,onProgress:r})},e.prototype.onResourceLoadComplete=function(e){var t=e.groupName;if(RES.isGroupLoaded(t)){var r=this._loadingGroups.indexOf(t);if(r>=0&&this._loadingGroups.splice(r,1),this._groups[t]){for(var n=0;n<this._groups[t].length;n++){var o=this._groups[t][n].onComplete,a=this._groups[t][n].thisObject;null!=o&&o.call(a)}this._groups[t]=null,delete this._groups[t]}}},e.prototype.onResourceLoadProgress=function(e){var t=e.groupName;if(this._groups[t])for(var r=0;r<this._groups[t].length;r++){var n=this._groups[t][r].onProgress,o=this._groups[t][r].thisObject;null!=n&&n.call(o,e)}},e.prototype.onResourceLoadError=function(e){this.onResourceLoadComplete(e)},e.prototype.loadAsyncSound=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return RES.getResByUrl(PathManager.Instance.SoundPath+e,function(){t&&t()},this,RES.ResourceItem.TYPE_SOUND),[2]})})},Object.defineProperty(e,"getInstance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.PRIORITY_H=10,e.PRIORITY_M=5,e.PRIORITY_L=1,e}();__reflect(ResUtil.prototype,"ResUtil");var ShakeUtils=function(){function e(){this.count=0}return Object.defineProperty(e,"Instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.shakeObj=function(e,t,r,n){this.target=e,this.initX=e.x,this.initY=e.y,this.maxDis=n,this.count=t*r,this.rate=r,App.TimerManager.doTimer(1e3/r,this.count,this.shaking,this,this.shakeComplete,this)},e.prototype.shaking=function(){egret.Tween.removeTweens(this.target),this.target.x=this.initX-this.maxDis+Math.random()*this.maxDis*2,this.target.y=this.initY-this.maxDis+Math.random()*this.maxDis*2,egret.Tween.get(this.target).to({x:this.initX,y:this.initY},999/this.rate)},e.prototype.shakeComplete=function(){this.target&&(egret.Tween.removeTweens(this.target),this.target.x=this.initX,this.target.y=this.initY),App.TimerManager.remove(this.shaking,this)},e.prototype.stop=function(){this.shakeComplete()},e}();__reflect(ShakeUtils.prototype,"ShakeUtils");var StageUtils=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t,"getInstance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.setup=function(e){this.stage=e,this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTab,this)},t.prototype.onStageTab=function(e){},t.getStageScaleX=function(){return t.getInstance.stage.stageWidth/t.StanderWidth},t.getStageScaleY=function(){return t.getInstance.stage.stageHeight/t.StanderHeight},t.fillFullStageH=function(e){var r=(t.getInstance.stage.stageWidth,t.getInstance.stage.stageHeight);e.width=r/e.height*e.scaleY*e.width,e.height=r},t.centerDisplayToStage=function(e){var r=t.getInstance.stage.stageWidth,n=t.getInstance.stage.stageHeight;e.x=(r-e.width)/2,e.y=(n-e.height)/2},t.setScaleMode=function(e){t.getInstance.stage.scaleMode=e},t.setFrameRate=function(e){t.getInstance.stage.frameRate=e},t.prototype.startFullscreenAdaptation=function(e,t,r){this.designWidth=e,this.designHeight=t,this.resizeCallback=r,this.stageOnResize()},t.prototype.stageOnResize=function(){this.getStage().removeEventListener(egret.Event.RESIZE,this.stageOnResize,this);var e=this.designWidth,t=this.designHeight,r=window.innerWidth,n=window.innerHeight,o=r/n,a=e/t,i=o/a;if(o>a){var s=i,c=i;e=Math.floor(e*s),t=Math.floor(t*c)}this.getStage().setContentSize(e,t),this.resizeCallback&&this.resizeCallback(),this.getStage().addEventListener(egret.Event.RESIZE,this.stageOnResize,this)},t.prototype.getStage=function(){return egret.MainContext.instance.stage},t.StanderWidth=750,t.StanderHeight=1334,t}(egret.EventDispatcher);__reflect(StageUtils.prototype,"StageUtils");var TimeUtil=function(){function e(){this._initializeSTime=0,this._initializeCTime=0,this._firstSTime=0,this._isLogin=!1}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.S2H=function(e,t,r){if(void 0===t&&(t=":"),void 0===r&&(r=!0),!(0>e)){var n=Math.floor(e/1e3/60/60).toString(),o=Math.floor(e%36e5/6e4).toString(),a=Math.floor(e%6e4/1e3).toString();if(Number(n)<10&&(n="0"+n),Number(o)<10&&(o="0"+o),Number(a)<10&&(a="0"+a),r)var i=n+t+o+t+a;else var i=o+t+a;return i}},e.getCDTime=function(e){if(!(0>e)){var t=Math.floor(e/1e3/60/60).toString(),r=Math.floor(e%36e5/6e4).toString(),n=Math.floor(e%6e4/1e3).toString();return Number(t)>0?t+"h":Number(r)>0?r+"m":Number(n)>0?n+"s":"0"}},e.conversionTime=function(t){if(0>=t)return"";if(t>=86400){var r=Math.floor(t/86400);return r+"天"}if(t>=3600){var n=Math.floor(t/3600);return n+"小时"}return e.S2H(1e3*t)},e.getHours=function(e){return 0>e?void 0:Math.floor(e/1e3/60/60)},e.fornatStr=function(t){var r=t.split("|"),n={};if(r&&r.length)for(var o=0;o<r.length;o++){var a=e.fornatStr1(r[o]),i={id:a[0],itemtType:a[1],num:a[2]};n[a[0]]=i}return n},e.fornatStr1=function(e,t){void 0===t&&(t="#");var r=e.split(t);return r},e.prototype.getCurServerTime=function(){var e=this._initializeSTime+Math.floor((new Date).getTime()/1e3)-this._initializeCTime;return e},e.prototype.getEndTime=function(e){return this._firstSTime+e},e.prototype.getCDTime=function(e){var t=this.getEndTime(e),r=this.getCurServerTime();return r>=t?0:t-r},e.prototype.getCDTimes=function(e){var t=this.getCurServerTime();if(t>=e)return 0;var r=e-t;return r},e.prototype.synctime=function(e,t){this._initializeCTime=t,this._initializeSTime=e,this._isLogin||(this._firstSTime=e,this._isLogin=!0)},e.prototype.calculationTimestamp=function(e){var t=e-1e3*this.getCurServerTime();return t=Math.floor(t)},e.fornateTimestamp=function(e){var t=new Date;t.setTime(e);var r=t.getTime();return r=Math.floor(r/1e3)},e.getDay=function(e){if(!(0>=e)){var t=new Date;return t.setTime(e),t.getDate()+"天"}},e}();__reflect(TimeUtil.prototype,"TimeUtil");var utils;!function(e){var t;!function(e){function t(e){var t="",r=new Date;return r.setTime(e),t+=r.getFullYear(),t+="-"+i(r),t+="-"+s(r),t+="  "+c(r),t+=":"+u(r),t+=":"+p(r)}function r(e){var t="",r=new Date;return r.setTime(e),t+=r.getFullYear(),t+=i(r),t+=s(r),parseInt(t)}function n(e){var t="",r=new Date;return r.setTime(e),t+=i(r)+"月",t+=s(r)+"日"}function o(e){var t="",r=new Date;return r.setTime(e),t+=c(r),t+=u(r),t+=p(r),parseInt(t)}function a(e){var t="",r=new Date;return r.setTime(e),t+=c(r),t+=":"+u(r)}function i(e){var t="";return t=e.getMonth()+1,parseInt(t)<10&&(t="0"+t),t}function s(e){var t="";return t=e.getDate(),parseInt(t)<10&&(t="0"+t),t}function c(e){var t="";return t=e.getHours(),parseInt(t)<10&&(t="0"+t),t}function u(e){var t="";return t=e.getMinutes(),parseInt(t)<10&&(t="0"+t),t}function p(e){var t="";return t=e.getSeconds(),parseInt(t)<10&&(t="0"+t),t}e.datetimeFormat=t,e.getYYMMDD=r,e.MMDDFormat=n,e.getHHMMSS=o,e.HHMMFormat=a}(t=e.timer||(e.timer={}))}(utils||(utils={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,r,n){function o(e){t.call(n,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),r.call(n))}var i=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,r){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},i)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var s=e.split("/");s.pop();var c=s.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(n,generateJSON.paths[e])},this):RES.getResByUrl(c,function(r){window.JSONParseClass.setData(r),egret.callLater(function(){t.call(n,generateJSON.paths[e])},i)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var UIUtil=function(){function e(){}return e.createAlert=function(e){var t=e,r=new t;return r.uiName=e+"",r},e.createPanel=function(e,t){void 0===t&&(t=!1);var r=e,n=new r;return t?n.uiName=e+Math.random()+"":n.uiName=e+"",n},e.createScene=function(e){var t=e,r=new t;return r.uiName=e+"",r},e.setFilters=function(e){if(e){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],r=new egret.ColorMatrixFilter(t);e.filters=[r]}},e.setObjFilters=function(e){if(e){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],r=new egret.ColorMatrixFilter(t);e.filters=[r]}},e.changeColor=function(e,t){e&&(t?e.textColor=5256759:e.textColor=16711680)},e.setText=function(e,t){if(void 0===t&&(t=""),e){var r=new egret.HtmlTextParser;e.textFlow=r.parser(t)}},e.getHtmlText=function(e){if(""==e)return null;var t=new egret.TextField,r=new egret.HtmlTextParser;return t.textFlow=r.parser(e),t},e}();__reflect(UIUtil.prototype,"UIUtil");var BoneAnimationVO=function(){function e(){this._positionOffset=""}return Object.defineProperty(e.prototype,"currentAnimationName",{get:function(){return this._currentAnimationName},set:function(e){"0"!=e&&(this._currentAnimationName=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"detectFrameEvent",{get:function(){return this._detectFrameEvent},set:function(e){this._detectFrameEvent=1==Number(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removeAtLastFrame",{get:function(){return this._removeAtLastFrame},set:function(e){this._removeAtLastFrame=1==Number(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPauseAtLastFrame",{get:function(){return this._isPauseAtLastFrame},set:function(e){this._isPauseAtLastFrame=1==Number(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removeWhenRemoveFromStage",{get:function(){return this._removeWhenRemoveFromStage},set:function(e){this._removeWhenRemoveFromStage=1==Number(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positionOffset",{get:function(){return this._positionOffset},set:function(e){"0"!=e&&(this._positionOffset=e)},enumerable:!0,configurable:!0}),e}();__reflect(BoneAnimationVO.prototype,"BoneAnimationVO");var ServerConfigVO=function(){function e(){}return e}();__reflect(ServerConfigVO.prototype,"ServerConfigVO");var SoundVO=function(){function e(){}return e}();__reflect(SoundVO.prototype,"SoundVO");var EventName=function(){function e(){}return e.ITEM_CLICK="ITEM_CLICK",e}();__reflect(EventName.prototype,"EventName");var LogicManager=function(e){function t(){var t=e.call(this)||this;return t.hammerTimes=1,t.refreshTimes=2,t.score=0,t}return __extends(t,e),Object.defineProperty(t,"getInstance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.setup=function(){var e=this;EventsManager.getInstance.addEventListener(EventName.ITEM_CLICK,e.onTetrisItemClick,e)},t.prototype.onTetrisItemClick=function(e){},t.prototype.outOfMap=function(e){for(var r=e.itemList.length,n=0;r>n;n++)for(var o=e.itemList[n].length,a=0;o>a;a++){var i=e.itemList[n][a];if(i.x+e.x+i.width/2<0||i.x+e.x+i.width/2>=i.width*t.MAP_ROW||i.y+e.y+i.height/2<0||i.y+e.y+i.height/2>=i.height*t.MAP_COL)return!0}return!1},t.prototype.inTouchArea=function(e,t,r,n,o){return e+r/2>=o.x&&e+r/2<o.x+o.width&&t+n/2>=o.y&&t+n/2<o.y+o.height?!0:!1},t.prototype.betweenTwoNumber=function(e,t,r){return e>=t&&r>=e?!0:!1},t.MAP_ROW=8,t.MAP_COL=8,t.RANDOM_COUNT=3,t.HAMMER_AREA=1,t.HAMMER_TIMES=1,t.REFRESH_TIMES=2,t}(egret.EventDispatcher);__reflect(LogicManager.prototype,"LogicManager");var BlockItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=SkinName.BlockItemSkin,t}return __extends(t,e),t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),t.addEvents()},t.prototype.setData=function(e,t,r){var n=this;n.iconColor=e,n.icon.source="game_json.item"+e,n.row=t,n.col=r},t.prototype.addEvents=function(){},t.prototype.removeEvents=function(){},t.prototype.dispose=function(){var e=this;e.removeEvents(),DisplayUtils.removeFromParent(e)},t}(eui.Component);__reflect(BlockItem.prototype,"BlockItem");var MapItem=function(e){function t(t,r){var n=e.call(this)||this;return n._state=0,n.row=0,n.col=0,n.destroy=0,n.skinName=SkinName.MapItemSkin,n.row=t,n.col=r,n}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.setIconType=function(e,t){var r=this;r.color=e,r.icon.source="game_json.item"+e,r._state=t,0==r._state?(r.icon.visible=!1,r.showDestroyShadow(0)):1==r._state?(r.icon.visible=!0,r.icon.alpha=1):(r.icon.visible=!0,r.icon.alpha=.5)},t.prototype.showDestroyShadow=function(e){var t=this;t.destroy=e,t.alpha=0!=e?.5:1},Object.defineProperty(t.prototype,"state",{get:function(){var e=this;return e._state},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=this;DisplayUtils.removeFromParent(e)},t}(eui.Component);__reflect(MapItem.prototype,"MapItem");var TetrisItem=function(e){function t(){var t=e.call(this)||this;return t.shapeList=[[[1]],[[1,1]],[[1],[1]],[[1,1,1]],[[1],[1],[1]],[[1,0],[1,1]],[[0,1],[1,1]],[[1,1],[0,1]],[[1,1],[1,0]],[[1,1],[1,1]],[[1,1,1,1]],[[1],[1],[1],[1]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]],[[0,1],[1,1],[1,0]],[[1,0],[1,1],[0,1]],[[1,1],[1,0],[1,0]],[[1,1],[0,1],[0,1]],[[1,0],[1,0],[1,1]],[[0,1],[0,1],[1,1]],[[1,1,1],[0,0,1]],[[1,1,1],[1,0,0]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1,1,1,1]],[[1],[1],[1],[1],[1]],[[1,1,1],[0,0,1],[0,0,1]],[[1,1,1],[1,0,0],[1,0,0]],[[0,0,1],[0,0,1],[1,1,1]],[[1,0,0],[1,0,0],[1,1,1]],[[1,1,1],[1,1,1],[1,1,1]]],t.weightList=[4,4,4,4,4,2,2,2,2,4,4,4,2,2,2,2,1,1,1,1,1,1,1,1,4,4,2,2,2,2,4],t.totalWeight=0,t.shapeLen=0,t.myShape=[],t.state=0,t._canUse=!0,t.itemList=[],t.skinName=SkinName.TetrisItemSkin,t}return __extends(t,e),t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),t.initData(),t.initView(),t.addEvent()},t.prototype.initView=function(){var e=this;e.addChild(e.iconGroup),e.ranColor=Math.floor(6*Math.random())+1,e.creatShape(e.shapeList[e.getRandomShape()],e.ranColor)},t.prototype.initData=function(){var e=this;e.totalWeight=0,e.shapeLen=e.weightList.length;for(var t=0;t<e.shapeLen;t++)e.totalWeight+=e.weightList[t]},Object.defineProperty(t.prototype,"canUse",{get:function(){var e=this;return e._canUse},set:function(e){var t=this;t._canUse=e,t._canUse?t.filters=null:UIUtil.setFilters(t)},enumerable:!0,configurable:!0}),t.prototype.getRandomShape=function(){for(var e=this,t=Math.floor(e.totalWeight*Math.random())+1,r=0;r<e.shapeLen;r++){if(t<=e.weightList[r])return r;t-=e.weightList[r]}return 0},t.prototype.creatShape=function(e,t){var r=this;r.myShape=e.concat();var n=r.myShape.length;r.itemList=[],DisplayUtils.removeAllChildren(r.iconGroup);for(var o=0;n>o;o++){for(var a=r.myShape[o].length,i=[],s=0;a>s;s++)if(0!=r.myShape[o][s]){var c=new BlockItem;c.setData(t,o,s),c.x=s*c.width,c.y=o*c.height,r.iconGroup.addChild(c),i.push(c)}r.itemList.push(i)}},t.prototype.showAllShape=function(){var e=this;e.shapeList[Math.floor(e.shapeLen*Math.random())];console.log("self.shapeLen :"+e.shapeLen);for(var t=0;t<e.shapeLen;t++){for(var r=e.shapeList[t].length,n=new egret.Sprite,o=Math.floor(6*Math.random())+1,a=0;r>a;a++)for(var i=e.shapeList[t][a].length,s=0;i>s;s++)if(0!=e.shapeList[t][a][s]){var c=new BlockItem;c.setData(o,a,s),c.x=s*c.width,c.y=a*c.height,n.addChild(c)}n.x=t%4*150,n.y=150*Math.floor(t/4),n.scaleX=n.scaleY=.4,e.addChild(n)}},t.prototype.addEvent=function(){var e=this;e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHandler,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.removeFromStage,e)},t.prototype.removeEvent=function(){var e=this;e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHandler,e)
},t.prototype.removeFromStage=function(){var e=this;e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,e.removeFromStage,e),e.dispose()},t.prototype.touchBeginHandler=function(){var e=this;EventsManager.getInstance.dispatchEventWith(EventName.ITEM_CLICK,!1,{type:e.ranColor,shape:e.myShape})},t.prototype.setVisible=function(e){var t=this;t.iconGroup.visible=e},t.prototype.dispose=function(){var e=this;e.removeEvent(),DisplayUtils.removeFromParent(e)},t}(eui.Component);__reflect(TetrisItem.prototype,"TetrisItem");var PlayerInfo=function(){function e(){}return e}();__reflect(PlayerInfo.prototype,"PlayerInfo");var DisplayLayer=function(e){function t(){var t=e.call(this)||this;t.layerName="",t.layerType=-1;return t}return __extends(t,e),t}(eui.UILayer);__reflect(DisplayLayer.prototype,"DisplayLayer");